# Antrea Results

The following is a dump of all results for antrea.

```
Version: 0.4.0
Git SHA: 9374a1a7511cfd4e1f1955bbcb46f247b91b0fe2
Build time: 2021-03-27T11:07:15Z
time="2021-03-27T15:23:20Z" level=info msg="log level set to 'info'"
time="2021-03-27T15:23:27Z" level=info msg="waiting for 9 pods to be running and have IP addresses; currently 7 are ready"
resources:
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| NAMESPACE | NS LABELS | POD | POD LABELS |          IPS           |        CONTAINERS/PORTS        |
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| x         | ns: x     | a   | pod: a     | pod: 10.10.1.2         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.159.33  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | b   | pod: b     | pod: 10.10.2.5         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.128.22  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | c   | pod: c     | pod: 10.10.1.3         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.17.112  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| y         | ns: y     | a   | pod: a     | pod: 10.10.2.6         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.48.51   | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | b   | pod: b     | pod: 10.10.1.4         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.196.194 | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | c   | pod: c     | pod: 10.10.2.7         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.68.196  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| z         | ns: z     | a   | pod: a     | pod: 10.10.1.5         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.36.133  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | b   | pod: b     | pod: 10.10.2.8         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.211.7   | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | c   | pod: c     | pod: 10.10.1.6         | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.50.186  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+-----------+-----------+-----+------------+------------------------+--------------------------------+

test cases to run by tag:
- set-pod-labels: 1
- pathological: 6
- target-pod-selector: 3
- named-port: 24
- ingress: 51
- tcp: 16
- udp: 16
- delete-pod: 1
- direction: 100
- all-namespaces: 10
time="2021-03-27T15:23:33Z" level=info msg="test #1 to run: set namespace to x"
time="2021-03-27T15:23:33Z" level=info msg="test #2 to run: set namespace to y"
time="2021-03-27T15:23:33Z" level=info msg="test #3 to run: set namespace to z"
time="2021-03-27T15:23:33Z" level=info msg="test #4 to run: set pod selector to [\"MatchLabels\",null,\"MatchExpression\",null]"
time="2021-03-27T15:23:33Z" level=info msg="test #5 to run: set pod selector to [\"MatchLabels\",[\"pod: a\"],\"MatchExpression\",null]"
time="2021-03-27T15:23:33Z" level=info msg="test #6 to run: set pod selector to [\"MatchLabels\",null,\"MatchExpression\",[{\"key\":\"pod\",\"operator\":\"In\",\"values\":[\"a\",\"b\"]}]]"
time="2021-03-27T15:23:33Z" level=info msg="test #7 to run: egress: deny all"
- any-port: 14
- egress: 51
- pods-by-label: 6
- update-policy: 1
- sctp: 10
- conflict: 16
- any-port-protocol: 2
- upstream-e2e: 0
- any-peer: 2
- protocol: 42
time="2021-03-27T15:23:33Z" level=info msg="test #8 to run: egress: allow all"
time="2021-03-27T15:23:33Z" level=info msg="test #9 to run: ingress: deny all"
- action: 6
- target-namespace: 3
- create-policy: 2
- peer-ipblock: 4
- policy-stack: 0
- delete-namespace: 1
- set-namespace-labels: 1
time="2021-03-27T15:23:33Z" level=info msg="test #10 to run: ingress: allow all"
time="2021-03-27T15:23:33Z" level=info msg="test #11 to run: ingress: empty peers"
time="2021-03-27T15:23:33Z" level=info msg="test #12 to run: egress: empty peers"
time="2021-03-27T15:23:33Z" level=info msg="test #13 to run: empty pods + nil ns"
time="2021-03-27T15:23:33Z" level=info msg="test #14 to run: pods by label + nil ns"
time="2021-03-27T15:23:33Z" level=info msg="test #15 to run: nil pods + empty ns"
time="2021-03-27T15:23:33Z" level=info msg="test #16 to run: empty pods + empty ns"
time="2021-03-27T15:23:33Z" level=info msg="test #17 to run: pods by label + empty ns"
time="2021-03-27T15:23:33Z" level=info msg="test #18 to run: nil pods + ns by label"
time="2021-03-27T15:23:33Z" level=info msg="test #19 to run: empty pods + ns by label"
time="2021-03-27T15:23:33Z" level=info msg="test #20 to run: pods by label + ns by label"
time="2021-03-27T15:23:33Z" level=info msg="test #21 to run: simple ipblock"
time="2021-03-27T15:23:33Z" level=info msg="test #22 to run: ipblock with except"
time="2021-03-27T15:23:33Z" level=info msg="test #23 to run: empty pods + nil ns"
time="2021-03-27T15:23:33Z" level=info msg="test #24 to run: pods by label + nil ns"
time="2021-03-27T15:23:33Z" level=info msg="test #25 to run: nil pods + empty ns"
time="2021-03-27T15:23:33Z" level=info msg="test #26 to run: empty pods + empty ns"
time="2021-03-27T15:23:33Z" level=info msg="test #27 to run: pods by label + empty ns"
time="2021-03-27T15:23:33Z" level=info msg="test #28 to run: nil pods + ns by label"
time="2021-03-27T15:23:33Z" level=info msg="test #29 to run: empty pods + ns by label"
time="2021-03-27T15:23:33Z" level=info msg="test #30 to run: pods by label + ns by label"
time="2021-03-27T15:23:33Z" level=info msg="test #31 to run: simple ipblock"
time="2021-03-27T15:23:33Z" level=info msg="test #32 to run: ipblock with except"
time="2021-03-27T15:23:33Z" level=info msg="test #33 to run: egress: empty port/protocol"
time="2021-03-27T15:23:33Z" level=info msg="test #34 to run: ingress: empty port/protocol"
time="2021-03-27T15:23:33Z" level=info msg="test #35 to run: any-port,direction,egress,port"
time="2021-03-27T15:23:33Z" level=info msg="test #36 to run: direction,egress,numbered-port,port"
time="2021-03-27T15:23:33Z" level=info msg="test #37 to run: direction,egress,numbered-port,port"
time="2021-03-27T15:23:33Z" level=info msg="test #38 to run: any-port,direction,egress,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #39 to run: direction,egress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #40 to run: direction,egress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #41 to run: any-port,direction,egress,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #42 to run: direction,egress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #43 to run: direction,egress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #44 to run: any-port,direction,egress,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #45 to run: direction,egress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #46 to run: direction,egress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #47 to run: direction,egress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #48 to run: direction,egress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #49 to run: direction,egress,named-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #50 to run: direction,egress,named-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #51 to run: direction,egress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #52 to run: direction,egress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #53 to run: open a named port that doesn't match its protocol"
time="2021-03-27T15:23:33Z" level=info msg="test #54 to run: open a named port that isn't served"
time="2021-03-27T15:23:33Z" level=info msg="test #55 to run: open a numbered port that isn't served"
- multi-peer: 0
- example: 0
- delete-policy: 1
- policy-namespace: 4
- numbered-port: 28
- peer-pods: 20
- multi-port/protocol: 14
- ip-block-with-except: 2
- all-pods: 14
- rule: 30
- deny-all: 10
- namespaces-by-label: 6
- miscellaneous: 22
- port: 56
- create-pod: 1
time="2021-03-27T15:23:33Z" level=info msg="test #56 to run: any-port,direction,ingress,port"
time="2021-03-27T15:23:33Z" level=info msg="test #57 to run: direction,ingress,numbered-port,port"
time="2021-03-27T15:23:33Z" level=info msg="test #58 to run: direction,ingress,numbered-port,port"
time="2021-03-27T15:23:33Z" level=info msg="test #59 to run: any-port,direction,ingress,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #60 to run: direction,ingress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #61 to run: direction,ingress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #62 to run: any-port,direction,ingress,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #63 to run: direction,ingress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #64 to run: direction,ingress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #65 to run: any-port,direction,ingress,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #66 to run: direction,ingress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #67 to run: direction,ingress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #68 to run: direction,ingress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #69 to run: direction,ingress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:33Z" level=info msg="test #70 to run: direction,ingress,named-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #71 to run: direction,ingress,named-port,port,protocol,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #72 to run: direction,ingress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #73 to run: direction,ingress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:33Z" level=info msg="test #74 to run: open a named port that doesn't match its protocol"
time="2021-03-27T15:23:33Z" level=info msg="test #75 to run: open a named port that isn't served"
time="2021-03-27T15:23:33Z" level=info msg="test #76 to run: open a numbered port that isn't served"
time="2021-03-27T15:23:33Z" level=info msg="test #77 to run: any-port,direction,egress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #78 to run: any-port,direction,egress,multi-port/protocol,named-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #79 to run: any-port,direction,egress,multi-port/protocol,port,protocol,rule,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #80 to run: direction,egress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #81 to run: direction,egress,multi-port/protocol,named-port,numbered-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #82 to run: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #83 to run: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #84 to run: any-port,direction,ingress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #85 to run: any-port,direction,ingress,multi-port/protocol,named-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #86 to run: any-port,direction,ingress,multi-port/protocol,port,protocol,rule,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #87 to run: direction,ingress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #88 to run: direction,ingress,multi-port/protocol,named-port,numbered-port,port,rule"
time="2021-03-27T15:23:33Z" level=info msg="test #89 to run: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #90 to run: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:33Z" level=info msg="test #91 to run: Create/delete policy"
time="2021-03-27T15:23:33Z" level=info msg="test #92 to run: Create/update policy"
time="2021-03-27T15:23:33Z" level=info msg="test #93 to run: Create/delete namespace"
time="2021-03-27T15:23:33Z" level=info msg="test #94 to run: Update namespace so that policy applies, then again so it no longer applies"
time="2021-03-27T15:23:33Z" level=info msg="test #95 to run: Create/delete pod"
time="2021-03-27T15:23:33Z" level=info msg="test #96 to run: Update pod so that policy applies, then again so it no longer applies"
time="2021-03-27T15:23:33Z" level=info msg="test #97 to run: deny all from source, allow all to dest"
time="2021-03-27T15:23:33Z" level=info msg="test #98 to run: allow all from source, deny all to dest"
time="2021-03-27T15:23:33Z" level=info msg="test #99 to run: deny all + allow all from same source"
time="2021-03-27T15:23:33Z" level=info msg="test #100 to run: deny all + allow all to same dest"
time="2021-03-27T15:23:33Z" level=info msg="test #101 to run: deny all + allow all by pod from same source"
time="2021-03-27T15:23:33Z" level=info msg="test #102 to run: deny all + allow all by IP from same source"
time="2021-03-27T15:23:33Z" level=info msg="test #103 to run: deny all by IP + allow all by pod from same source"
time="2021-03-27T15:23:33Z" level=info msg="test #104 to run: deny all by pod + allow all by IP from same source"
time="2021-03-27T15:23:33Z" level=info msg="test #105 to run: deny all + allow all by pod to same source"
time="2021-03-27T15:23:33Z" level=info msg="test #106 to run: deny all + allow all by IP to same source"
time="2021-03-27T15:23:33Z" level=info msg="test #107 to run: deny all by IP + allow all by pod to same source"
time="2021-03-27T15:23:33Z" level=info msg="test #108 to run: deny all by pod + allow all by IP to same source"
time="2021-03-27T15:23:33Z" level=info msg="test #109 to run: egress: deny all by IP"
time="2021-03-27T15:23:33Z" level=info msg="test #110 to run: egress: deny all by pod"
time="2021-03-27T15:23:33Z" level=info msg="test #111 to run: ingress: deny all by IP"
time="2021-03-27T15:23:33Z" level=info msg="test #112 to run: ingress: deny all by pod"
time="2021-03-27T15:23:33Z" level=info msg="starting test case #1"
- target: 6
- ip-block-no-except: 2
- create-namespace: 1
- allow-all: 6
testing 112 cases

time="2021-03-27T15:23:38Z" level=info msg="cluster state reset"
time="2021-03-27T15:23:41Z" level=info msg="cluster state verified"
time="2021-03-27T15:23:41Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:23:56Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:23:56Z" level=info msg="running kube probe on try 1"
evaluating test case: set namespace to x
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:24:19Z" level=info msg="finished policy #1"
time="2021-03-27T15:24:19Z" level=info msg="starting test case #2"
time="2021-03-27T15:24:22Z" level=info msg="cluster state reset"
time="2021-03-27T15:24:25Z" level=info msg="cluster state verified"
time="2021-03-27T15:24:25Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:24:40Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:24:40Z" level=info msg="running kube probe on try 1"
evaluating test case: set namespace to y
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: y  | y/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: y  | y/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: "y"
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | X   | X   | X   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:25:03Z" level=info msg="finished policy #2"
time="2021-03-27T15:25:03Z" level=info msg="starting test case #3"
time="2021-03-27T15:25:06Z" level=info msg="cluster state reset"
time="2021-03-27T15:25:09Z" level=info msg="cluster state verified"
time="2021-03-27T15:25:09Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:25:24Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:25:24Z" level=info msg="running kube probe on try 1"
evaluating test case: set namespace to z
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: z  | z/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: z  | z/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: z
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:25:48Z" level=info msg="finished policy #3"
time="2021-03-27T15:25:48Z" level=info msg="starting test case #4"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | X   | X   | .   | .   | X   | X   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:25:51Z" level=info msg="cluster state reset"
time="2021-03-27T15:25:54Z" level=info msg="cluster state verified"
time="2021-03-27T15:25:54Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:26:09Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:26:09Z" level=info msg="running kube probe on try 1"
evaluating test case: set pod selector to ["MatchLabels",null,"MatchExpression",null]
step 1 on all available ports/protocols:
Policy explanation:
+---------+--------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET    | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+--------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x | x/base       | no ips                        | no ports, no protocols  |
|         | all pods     |              |                               |                         |
+         +              +              +-------------------------------+-------------------------+
|         |              |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |              |              |   ns In [x y]                 |                         |
|         |              |              | pods: Match expressions:      |                         |
|         |              |              |   pod In [b c]                |                         |
+---------+--------------+--------------+-------------------------------+-------------------------+
|         |              |              |                               |                         |
+---------+--------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | all pods     |              |                               |                         |
+         +              +              +-------------------------------+-------------------------+
|         |              |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |              |              |   ns In [y z]                 |                         |
|         |              |              | pods: Match expressions:      |                         |
|         |              |              |   pod In [a b]                |                         |
+         +              +              +-------------------------------+-------------------------+
|         |              |              | namespace: all                | port 53 on protocol UDP |
|         |              |              | pods: all                     |                         |
+---------+--------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:26:34Z" level=info msg="finished policy #4"
time="2021-03-27T15:26:34Z" level=info msg="starting test case #5"
time="2021-03-27T15:26:37Z" level=info msg="cluster state reset"
time="2021-03-27T15:26:40Z" level=info msg="cluster state verified"
time="2021-03-27T15:26:40Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:26:55Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:26:55Z" level=info msg="running kube probe on try 1"
evaluating test case: set pod selector to ["MatchLabels",["pod: a"],"MatchExpression",null]
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

time="2021-03-27T15:27:18Z" level=info msg="finished policy #5"
time="2021-03-27T15:27:18Z" level=info msg="starting test case #6"
0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:27:21Z" level=info msg="cluster state reset"
time="2021-03-27T15:27:24Z" level=info msg="cluster state verified"
time="2021-03-27T15:27:24Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:27:39Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:27:39Z" level=info msg="running kube probe on try 1"
evaluating test case: set pod selector to ["MatchLabels",null,"MatchExpression",[{"key":"pod","operator":"In","values":["a","b"]}]]
step 1 on all available ports/protocols:
Policy explanation:
+---------+--------------------+--------------+-------------------------------+-------------------------+
|  TYPE   |       TARGET       | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+--------------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x       | x/base       | no ips                        | no ports, no protocols  |
|         | Match expressions: |              |                               |                         |
|         |   pod In [a b]     |              |                               |                         |
+         +                    +              +-------------------------------+-------------------------+
|         |                    |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |                    |              |   ns In [x y]                 |                         |
|         |                    |              | pods: Match expressions:      |                         |
|         |                    |              |   pod In [b c]                |                         |
+---------+--------------------+--------------+-------------------------------+-------------------------+
|         |                    |              |                               |                         |
+---------+--------------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x       | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match expressions: |              |                               |                         |
|         |   pod In [a b]     |              |                               |                         |
+         +                    +              +-------------------------------+                         +
|         |                    |              | namespace: all                |                         |
|         |                    |              | pods: all                     |                         |
|         |                    |              |                               |                         |
+         +                    +              +-------------------------------+-------------------------+
|         |                    |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |                    |              |   ns In [y z]                 |                         |
|         |                    |              | pods: Match expressions:      |                         |
|         |                    |              |   pod In [a b]                |                         |
+---------+--------------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchExpressions:
    - key: pod
      operator: In
      values:
      - a
      - b
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:28:02Z" level=info msg="finished policy #6"
time="2021-03-27T15:28:02Z" level=info msg="starting test case #7"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:28:05Z" level=info msg="cluster state reset"
time="2021-03-27T15:28:08Z" level=info msg="cluster state verified"
time="2021-03-27T15:28:08Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:28:23Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:28:23Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: deny all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | no pods, no ips               | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:30:54Z" level=info msg="finished policy #7"
time="2021-03-27T15:30:54Z" level=info msg="starting test case #8"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:30:57Z" level=info msg="cluster state reset"
time="2021-03-27T15:31:00Z" level=info msg="cluster state verified"
time="2021-03-27T15:31:00Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:31:15Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:31:15Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: allow all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | all pods, all ips             | all ports, all protocols |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - {}
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:31:38Z" level=info msg="finished policy #8"
time="2021-03-27T15:31:38Z" level=info msg="starting test case #9"
time="2021-03-27T15:31:41Z" level=info msg="cluster state reset"
time="2021-03-27T15:31:44Z" level=info msg="cluster state verified"
time="2021-03-27T15:31:44Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:31:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:31:59Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: deny all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no pods, no ips               | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:32:21Z" level=info msg="finished policy #9"
time="2021-03-27T15:32:21Z" level=info msg="starting test case #10"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:32:24Z" level=info msg="cluster state reset"
time="2021-03-27T15:32:27Z" level=info msg="cluster state verified"
time="2021-03-27T15:32:27Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:32:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:32:42Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: allow all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | all pods, all ips             | all ports, all protocols |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - {}
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:33:05Z" level=info msg="finished policy #10"
time="2021-03-27T15:33:05Z" level=info msg="starting test case #11"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:33:08Z" level=info msg="cluster state reset"
time="2021-03-27T15:33:11Z" level=info msg="cluster state verified"
time="2021-03-27T15:33:11Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:33:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:33:26Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: empty peers
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | ports for all IPs             | port 80 on protocol TCP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:33:48Z" level=info msg="finished policy #11"
time="2021-03-27T15:33:48Z" level=info msg="starting test case #12"
time="2021-03-27T15:33:51Z" level=info msg="cluster state reset"
time="2021-03-27T15:33:54Z" level=info msg="cluster state verified"
time="2021-03-27T15:33:54Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:34:09Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:34:09Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: empty peers
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 80 on protocol TCP |
|         | Match labels: |              |                               | port 53 on protocol UDP |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:34:32Z" level=info msg="finished policy #12"
time="2021-03-27T15:34:32Z" level=info msg="starting test case #13"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:34:34Z" level=info msg="cluster state reset"
time="2021-03-27T15:34:37Z" level=info msg="cluster state verified"
time="2021-03-27T15:34:37Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:34:52Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:34:53Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - podSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:35:15Z" level=info msg="finished policy #13"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:35:15Z" level=info msg="starting test case #14"
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:35:18Z" level=info msg="cluster state reset"
time="2021-03-27T15:35:21Z" level=info msg="cluster state verified"
time="2021-03-27T15:35:21Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:35:36Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:35:36Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - podSelector:
        matchLabels:
          pod: c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:35:59Z" level=info msg="finished policy #14"
time="2021-03-27T15:35:59Z" level=info msg="starting test case #15"
time="2021-03-27T15:36:01Z" level=info msg="cluster state reset"
time="2021-03-27T15:36:04Z" level=info msg="cluster state verified"
time="2021-03-27T15:36:05Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:36:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:36:20Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:36:42Z" level=info msg="finished policy #15"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:36:42Z" level=info msg="starting test case #16"
time="2021-03-27T15:36:45Z" level=info msg="cluster state reset"
time="2021-03-27T15:36:48Z" level=info msg="cluster state verified"
time="2021-03-27T15:36:48Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:37:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:37:03Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector: {}
      podSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:37:25Z" level=info msg="finished policy #16"
time="2021-03-27T15:37:25Z" level=info msg="starting test case #17"
time="2021-03-27T15:37:28Z" level=info msg="cluster state reset"
time="2021-03-27T15:37:31Z" level=info msg="cluster state verified"
time="2021-03-27T15:37:31Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:37:46Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:37:46Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector: {}
      podSelector:
        matchLabels:
          pod: c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:38:09Z" level=info msg="finished policy #17"
time="2021-03-27T15:38:09Z" level=info msg="starting test case #18"
time="2021-03-27T15:38:12Z" level=info msg="cluster state reset"
time="2021-03-27T15:38:15Z" level=info msg="cluster state verified"
time="2021-03-27T15:38:15Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:38:30Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:38:30Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          ns: x
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:38:52Z" level=info msg="finished policy #18"
time="2021-03-27T15:38:52Z" level=info msg="starting test case #19"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:38:55Z" level=info msg="cluster state reset"
time="2021-03-27T15:38:58Z" level=info msg="cluster state verified"
time="2021-03-27T15:38:58Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:39:13Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:39:13Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:39:36Z" level=info msg="finished policy #19"
time="2021-03-27T15:39:36Z" level=info msg="starting test case #20"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:39:39Z" level=info msg="cluster state reset"
time="2021-03-27T15:39:42Z" level=info msg="cluster state verified"
time="2021-03-27T15:39:42Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:39:57Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:39:57Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector:
        matchLabels:
          pod: c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:40:20Z" level=info msg="finished policy #20"
time="2021-03-27T15:40:20Z" level=info msg="starting test case #21"
time="2021-03-27T15:40:23Z" level=info msg="cluster state reset"
time="2021-03-27T15:40:26Z" level=info msg="cluster state verified"
time="2021-03-27T15:40:26Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:40:41Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:40:41Z" level=info msg="running kube probe on try 1"
time="2021-03-27T15:41:06Z" level=info msg="running kube probe on try 2"
evaluating test case: simple ipblock
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | ports for all IPs             | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 10.10.1.6/24                  | port 80 on protocol TCP |
|         |               |              | except []                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | no pods                       | no ports, no protocols  |
|         |               |              |                               |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - ipBlock:
        cidr: 10.10.1.6/24
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:41:29Z" level=info msg="finished policy #21"
time="2021-03-27T15:41:29Z" level=info msg="starting test case #22"
time="2021-03-27T15:41:32Z" level=info msg="cluster state reset"
time="2021-03-27T15:41:35Z" level=info msg="cluster state verified"
time="2021-03-27T15:41:35Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:41:50Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:41:50Z" level=info msg="running kube probe on try 1"
evaluating test case: ipblock with except
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | ports for all IPs             | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 10.10.1.6/24                  | port 80 on protocol TCP |
|         |               |              | except [10.10.1.6/28]         |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | no pods                       | no ports, no protocols  |
|         |               |              |                               |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - ipBlock:
        cidr: 10.10.1.6/24
        except:
        - 10.10.1.6/28
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:42:13Z" level=info msg="finished policy #22"
time="2021-03-27T15:42:13Z" level=info msg="starting test case #23"
time="2021-03-27T15:42:16Z" level=info msg="cluster state reset"
time="2021-03-27T15:42:19Z" level=info msg="cluster state verified"
time="2021-03-27T15:42:19Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:42:34Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:42:34Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - podSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:42:57Z" level=info msg="finished policy #23"
time="2021-03-27T15:42:57Z" level=info msg="starting test case #24"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:43:00Z" level=info msg="cluster state reset"
time="2021-03-27T15:43:03Z" level=info msg="cluster state verified"
time="2021-03-27T15:43:03Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:43:18Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:43:18Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - podSelector:
        matchLabels:
          pod: c
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | .   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:43:41Z" level=info msg="finished policy #24"
time="2021-03-27T15:43:41Z" level=info msg="starting test case #25"
time="2021-03-27T15:43:44Z" level=info msg="cluster state reset"
time="2021-03-27T15:43:47Z" level=info msg="cluster state verified"
time="2021-03-27T15:43:47Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:44:02Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:44:02Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     | port 53 on protocol UDP |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:44:24Z" level=info msg="finished policy #25"
time="2021-03-27T15:44:24Z" level=info msg="starting test case #26"
time="2021-03-27T15:44:27Z" level=info msg="cluster state reset"
time="2021-03-27T15:44:30Z" level=info msg="cluster state verified"
time="2021-03-27T15:44:30Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:44:45Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:44:45Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     | port 53 on protocol UDP |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector: {}
      podSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:45:07Z" level=info msg="finished policy #26"
time="2021-03-27T15:45:07Z" level=info msg="starting test case #27"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:45:10Z" level=info msg="cluster state reset"
time="2021-03-27T15:45:13Z" level=info msg="cluster state verified"
time="2021-03-27T15:45:13Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:45:28Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:45:28Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector: {}
      podSelector:
        matchLabels:
          pod: c
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:45:51Z" level=info msg="finished policy #27"
time="2021-03-27T15:45:51Z" level=info msg="starting test case #28"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | .   | X   | X   | .   | X   | X   | .   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:45:54Z" level=info msg="cluster state reset"
time="2021-03-27T15:45:57Z" level=info msg="cluster state verified"
time="2021-03-27T15:45:57Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:46:12Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:46:12Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          ns: x
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:46:35Z" level=info msg="finished policy #28"
time="2021-03-27T15:46:35Z" level=info msg="starting test case #29"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:46:38Z" level=info msg="cluster state reset"
time="2021-03-27T15:46:41Z" level=info msg="cluster state verified"
time="2021-03-27T15:46:41Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:46:56Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:46:56Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:47:19Z" level=info msg="finished policy #29"
time="2021-03-27T15:47:19Z" level=info msg="starting test case #30"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | .   | .   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:47:22Z" level=info msg="cluster state reset"
time="2021-03-27T15:47:25Z" level=info msg="cluster state verified"
time="2021-03-27T15:47:25Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:47:40Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:47:40Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector:
        matchLabels:
          pod: c
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | .   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:48:03Z" level=info msg="finished policy #30"
time="2021-03-27T15:48:03Z" level=info msg="starting test case #31"
time="2021-03-27T15:48:06Z" level=info msg="cluster state reset"
time="2021-03-27T15:48:09Z" level=info msg="cluster state verified"
time="2021-03-27T15:48:09Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:48:24Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:48:24Z" level=info msg="running kube probe on try 1"
evaluating test case: simple ipblock
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 10.10.1.6/24                  | port 80 on protocol TCP |
|         |               |              | except []                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - ipBlock:
        cidr: 10.10.1.6/24
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:48:47Z" level=info msg="finished policy #31"
time="2021-03-27T15:48:47Z" level=info msg="starting test case #32"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | .   | X   | .   | X   | .   | X   | .   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:48:50Z" level=info msg="cluster state reset"
time="2021-03-27T15:48:53Z" level=info msg="cluster state verified"
time="2021-03-27T15:48:53Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:49:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:49:08Z" level=info msg="running kube probe on try 1"
evaluating test case: ipblock with except
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 10.10.1.6/24                  | port 80 on protocol TCP |
|         |               |              | except [10.10.1.6/28]         |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - ipBlock:
        cidr: 10.10.1.6/24
        except:
        - 10.10.1.6/28
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
time="2021-03-27T15:49:31Z" level=info msg="finished policy #32"
time="2021-03-27T15:49:31Z" level=info msg="starting test case #33"
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:49:34Z" level=info msg="cluster state reset"
time="2021-03-27T15:49:37Z" level=info msg="cluster state verified"
time="2021-03-27T15:49:37Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:49:52Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:49:52Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: empty port/protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | all ports, all protocols |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:50:15Z" level=info msg="finished policy #33"
time="2021-03-27T15:50:15Z" level=info msg="starting test case #34"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:50:18Z" level=info msg="cluster state reset"
time="2021-03-27T15:50:21Z" level=info msg="cluster state verified"
time="2021-03-27T15:50:21Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:50:36Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:50:36Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: empty port/protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | all ports, all protocols |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+                          +
|         |               |              | namespace: all                |                          |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:50:59Z" level=info msg="finished policy #34"
time="2021-03-27T15:50:59Z" level=info msg="starting test case #35"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:51:01Z" level=info msg="cluster state reset"
time="2021-03-27T15:51:04Z" level=info msg="cluster state verified"
time="2021-03-27T15:51:04Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:51:19Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:51:19Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:51:42Z" level=info msg="finished policy #35"
time="2021-03-27T15:51:42Z" level=info msg="starting test case #36"
time="2021-03-27T15:51:45Z" level=info msg="cluster state reset"
time="2021-03-27T15:51:48Z" level=info msg="cluster state verified"
time="2021-03-27T15:51:48Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:52:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:52:03Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:52:26Z" level=info msg="finished policy #36"
time="2021-03-27T15:52:26Z" level=info msg="starting test case #37"
time="2021-03-27T15:52:29Z" level=info msg="cluster state reset"
time="2021-03-27T15:52:32Z" level=info msg="cluster state verified"
time="2021-03-27T15:52:32Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:52:47Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:52:47Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:53:10Z" level=info msg="finished policy #37"
time="2021-03-27T15:53:10Z" level=info msg="starting test case #38"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:53:12Z" level=info msg="cluster state reset"
time="2021-03-27T15:53:15Z" level=info msg="cluster state verified"
time="2021-03-27T15:53:15Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:53:30Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:53:30Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:53:54Z" level=info msg="finished policy #38"
time="2021-03-27T15:53:54Z" level=info msg="starting test case #39"
time="2021-03-27T15:53:57Z" level=info msg="cluster state reset"
time="2021-03-27T15:54:00Z" level=info msg="cluster state verified"
time="2021-03-27T15:54:00Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:54:15Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:54:15Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:54:38Z" level=info msg="finished policy #39"
time="2021-03-27T15:54:38Z" level=info msg="starting test case #40"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:54:41Z" level=info msg="cluster state reset"
time="2021-03-27T15:54:44Z" level=info msg="cluster state verified"
time="2021-03-27T15:54:44Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:54:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:54:59Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:55:22Z" level=info msg="finished policy #40"
time="2021-03-27T15:55:22Z" level=info msg="starting test case #41"
time="2021-03-27T15:55:25Z" level=info msg="cluster state reset"
time="2021-03-27T15:55:28Z" level=info msg="cluster state verified"
time="2021-03-27T15:55:28Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:55:43Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:55:43Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol UDP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:56:06Z" level=info msg="finished policy #41"
time="2021-03-27T15:56:06Z" level=info msg="starting test case #42"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:56:09Z" level=info msg="cluster state reset"
time="2021-03-27T15:56:12Z" level=info msg="cluster state verified"
time="2021-03-27T15:56:12Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:56:27Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:56:27Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:56:50Z" level=info msg="finished policy #42"
time="2021-03-27T15:56:50Z" level=info msg="starting test case #43"
time="2021-03-27T15:56:53Z" level=info msg="cluster state reset"
time="2021-03-27T15:56:56Z" level=info msg="cluster state verified"
time="2021-03-27T15:56:56Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:57:11Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:57:11Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol UDP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:57:34Z" level=info msg="finished policy #43"
time="2021-03-27T15:57:34Z" level=info msg="starting test case #44"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:57:37Z" level=info msg="cluster state reset"
time="2021-03-27T15:57:40Z" level=info msg="cluster state verified"
time="2021-03-27T15:57:40Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:57:55Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:57:55Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+----------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL        |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols     |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP    |
|         |               |              |   ns In [x y]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [b c]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
|         |               |              |                               |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP    |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+                            +
|         |               |              | namespace: all                |                            |
|         |               |              | pods: all                     |                            |
|         |               |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol SCTP |
|         |               |              |   ns In [y z]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [a b]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:58:18Z" level=info msg="finished policy #44"
time="2021-03-27T15:58:18Z" level=info msg="starting test case #45"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:58:21Z" level=info msg="cluster state reset"
time="2021-03-27T15:58:24Z" level=info msg="cluster state verified"
time="2021-03-27T15:58:24Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:58:39Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:58:39Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol SCTP |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:59:03Z" level=info msg="finished policy #45"
time="2021-03-27T15:59:03Z" level=info msg="starting test case #46"
time="2021-03-27T15:59:05Z" level=info msg="cluster state reset"
time="2021-03-27T15:59:08Z" level=info msg="cluster state verified"
time="2021-03-27T15:59:08Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T15:59:23Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:59:23Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol SCTP |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:59:47Z" level=info msg="finished policy #46"
time="2021-03-27T15:59:47Z" level=info msg="starting test case #47"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:59:50Z" level=info msg="cluster state reset"
time="2021-03-27T15:59:53Z" level=info msg="cluster state verified"
time="2021-03-27T15:59:53Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:00:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:00:08Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-tcp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-80-tcp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:00:31Z" level=info msg="finished policy #47"
time="2021-03-27T16:00:31Z" level=info msg="starting test case #48"
time="2021-03-27T16:00:34Z" level=info msg="cluster state reset"
time="2021-03-27T16:00:37Z" level=info msg="cluster state verified"
time="2021-03-27T16:00:37Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:00:52Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:00:52Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-tcp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-tcp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:01:14Z" level=info msg="finished policy #48"
time="2021-03-27T16:01:14Z" level=info msg="starting test case #49"
time="2021-03-27T16:01:17Z" level=info msg="cluster state reset"
time="2021-03-27T16:01:20Z" level=info msg="cluster state verified"
time="2021-03-27T16:01:20Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:01:35Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:01:35Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-udp on protocol UDP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-80-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:01:58Z" level=info msg="finished policy #49"
time="2021-03-27T16:01:58Z" level=info msg="starting test case #50"
time="2021-03-27T16:02:01Z" level=info msg="cluster state reset"
time="2021-03-27T16:02:04Z" level=info msg="cluster state verified"
time="2021-03-27T16:02:04Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:02:19Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:02:19Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol UDP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:02:41Z" level=info msg="finished policy #50"
time="2021-03-27T16:02:41Z" level=info msg="starting test case #51"
time="2021-03-27T16:02:44Z" level=info msg="cluster state reset"
time="2021-03-27T16:02:47Z" level=info msg="cluster state verified"
time="2021-03-27T16:02:47Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:03:02Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:03:02Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-sctp on protocol SCTP |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-80-sctp
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:03:24Z" level=info msg="finished policy #51"
time="2021-03-27T16:03:24Z" level=info msg="starting test case #52"
time="2021-03-27T16:03:27Z" level=info msg="cluster state reset"
time="2021-03-27T16:03:30Z" level=info msg="cluster state verified"
time="2021-03-27T16:03:30Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:03:45Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:03:45Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-sctp on protocol SCTP |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-sctp
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:04:07Z" level=info msg="finished policy #52"
time="2021-03-27T16:04:07Z" level=info msg="starting test case #53"
time="2021-03-27T16:04:10Z" level=info msg="cluster state reset"
time="2021-03-27T16:04:13Z" level=info msg="cluster state verified"
time="2021-03-27T16:04:13Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:04:28Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:04:28Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that doesn't match its protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-udp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:04:49Z" level=info msg="finished policy #53"
time="2021-03-27T16:04:49Z" level=info msg="starting test case #54"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:04:52Z" level=info msg="cluster state reset"
time="2021-03-27T16:04:55Z" level=info msg="cluster state verified"
time="2021-03-27T16:04:55Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:05:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:05:10Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:05:33Z" level=info msg="finished policy #54"
time="2021-03-27T16:05:33Z" level=info msg="starting test case #55"
evaluating test case: open a named port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-7981-udp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-7981-udp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:05:35Z" level=info msg="cluster state reset"
time="2021-03-27T16:05:38Z" level=info msg="cluster state verified"
time="2021-03-27T16:05:39Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:05:54Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:05:54Z" level=info msg="running kube probe on try 1"
evaluating test case: open a numbered port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 7981 on protocol TCP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 7981
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:06:16Z" level=info msg="finished policy #55"
time="2021-03-27T16:06:16Z" level=info msg="starting test case #56"
time="2021-03-27T16:06:19Z" level=info msg="cluster state reset"
time="2021-03-27T16:06:22Z" level=info msg="cluster state verified"
time="2021-03-27T16:06:22Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:06:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:06:37Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:07:00Z" level=info msg="finished policy #56"
time="2021-03-27T16:07:00Z" level=info msg="starting test case #57"
time="2021-03-27T16:07:03Z" level=info msg="cluster state reset"
time="2021-03-27T16:07:06Z" level=info msg="cluster state verified"
time="2021-03-27T16:07:06Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:07:21Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:07:21Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:07:44Z" level=info msg="finished policy #57"
time="2021-03-27T16:07:44Z" level=info msg="starting test case #58"
time="2021-03-27T16:07:47Z" level=info msg="cluster state reset"
time="2021-03-27T16:07:50Z" level=info msg="cluster state verified"
time="2021-03-27T16:07:50Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:08:05Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:08:05Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:08:28Z" level=info msg="finished policy #58"
time="2021-03-27T16:08:28Z" level=info msg="starting test case #59"
time="2021-03-27T16:08:31Z" level=info msg="cluster state reset"
time="2021-03-27T16:08:34Z" level=info msg="cluster state verified"
time="2021-03-27T16:08:34Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:08:49Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:08:49Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:09:12Z" level=info msg="finished policy #59"
time="2021-03-27T16:09:12Z" level=info msg="starting test case #60"
time="2021-03-27T16:09:15Z" level=info msg="cluster state reset"
time="2021-03-27T16:09:18Z" level=info msg="cluster state verified"
time="2021-03-27T16:09:18Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:09:33Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:09:33Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:09:56Z" level=info msg="finished policy #60"
time="2021-03-27T16:09:56Z" level=info msg="starting test case #61"
time="2021-03-27T16:09:58Z" level=info msg="cluster state reset"
time="2021-03-27T16:10:01Z" level=info msg="cluster state verified"
time="2021-03-27T16:10:01Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:10:16Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:10:16Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:10:39Z" level=info msg="finished policy #61"
time="2021-03-27T16:10:39Z" level=info msg="starting test case #62"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:10:42Z" level=info msg="cluster state reset"
time="2021-03-27T16:10:45Z" level=info msg="cluster state verified"
time="2021-03-27T16:10:45Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:11:00Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:11:00Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol UDP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T16:11:22Z" level=info msg="finished policy #62"
time="2021-03-27T16:11:22Z" level=info msg="starting test case #63"
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:11:25Z" level=info msg="cluster state reset"
time="2021-03-27T16:11:28Z" level=info msg="cluster state verified"
time="2021-03-27T16:11:28Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:11:43Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:11:43Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:12:07Z" level=info msg="finished policy #63"
time="2021-03-27T16:12:07Z" level=info msg="starting test case #64"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:12:10Z" level=info msg="cluster state reset"
time="2021-03-27T16:12:13Z" level=info msg="cluster state verified"
time="2021-03-27T16:12:13Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:12:28Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:12:28Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol UDP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:12:52Z" level=info msg="finished policy #64"
time="2021-03-27T16:12:52Z" level=info msg="starting test case #65"
time="2021-03-27T16:12:55Z" level=info msg="cluster state reset"
time="2021-03-27T16:12:58Z" level=info msg="cluster state verified"
time="2021-03-27T16:12:58Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:13:13Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:13:13Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+----------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL        |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols     |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol SCTP |
|         |               |              |   ns In [x y]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [b c]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
|         |               |              |                               |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP    |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP    |
|         |               |              |   ns In [y z]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [a b]                |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP    |
|         |               |              | pods: all                     |                            |
|         |               |              |                               |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:13:36Z" level=info msg="finished policy #65"
time="2021-03-27T16:13:36Z" level=info msg="starting test case #66"
time="2021-03-27T16:13:39Z" level=info msg="cluster state reset"
time="2021-03-27T16:13:42Z" level=info msg="cluster state verified"
time="2021-03-27T16:13:42Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:13:57Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:13:57Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol SCTP |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:14:21Z" level=info msg="finished policy #66"
time="2021-03-27T16:14:21Z" level=info msg="starting test case #67"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:14:24Z" level=info msg="cluster state reset"
time="2021-03-27T16:14:27Z" level=info msg="cluster state verified"
time="2021-03-27T16:14:27Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:14:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:14:42Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol SCTP |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+                          +
|         |               |              | namespace: all                |                          |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
time="2021-03-27T16:15:05Z" level=info msg="finished policy #67"
time="2021-03-27T16:15:05Z" level=info msg="starting test case #68"
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:15:08Z" level=info msg="cluster state reset"
time="2021-03-27T16:15:11Z" level=info msg="cluster state verified"
time="2021-03-27T16:15:11Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:15:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:15:26Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-tcp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-80-tcp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:15:49Z" level=info msg="finished policy #68"
time="2021-03-27T16:15:49Z" level=info msg="starting test case #69"
time="2021-03-27T16:15:52Z" level=info msg="cluster state reset"
time="2021-03-27T16:15:55Z" level=info msg="cluster state verified"
time="2021-03-27T16:15:55Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:16:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:16:10Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-tcp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+                                   +
|         |               |              | namespace: all                |                                   |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-tcp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:16:34Z" level=info msg="finished policy #69"
time="2021-03-27T16:16:34Z" level=info msg="starting test case #70"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:16:37Z" level=info msg="cluster state reset"
time="2021-03-27T16:16:40Z" level=info msg="cluster state verified"
time="2021-03-27T16:16:40Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:16:55Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:16:55Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-udp on protocol UDP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+                                   +
|         |               |              | namespace: all                |                                   |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-80-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:17:18Z" level=info msg="finished policy #70"
time="2021-03-27T16:17:18Z" level=info msg="starting test case #71"
time="2021-03-27T16:17:21Z" level=info msg="cluster state reset"
time="2021-03-27T16:17:24Z" level=info msg="cluster state verified"
time="2021-03-27T16:17:24Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:17:39Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:17:39Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol UDP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:18:02Z" level=info msg="finished policy #71"
time="2021-03-27T16:18:02Z" level=info msg="starting test case #72"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:18:05Z" level=info msg="cluster state reset"
time="2021-03-27T16:18:08Z" level=info msg="cluster state verified"
time="2021-03-27T16:18:08Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:18:23Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:18:23Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-sctp on protocol SCTP |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-80-sctp
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:18:47Z" level=info msg="finished policy #72"
time="2021-03-27T16:18:47Z" level=info msg="starting test case #73"
time="2021-03-27T16:18:49Z" level=info msg="cluster state reset"
time="2021-03-27T16:18:52Z" level=info msg="cluster state verified"
time="2021-03-27T16:18:52Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:19:07Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:19:07Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-sctp on protocol SCTP |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-sctp
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:19:31Z" level=info msg="finished policy #73"
time="2021-03-27T16:19:31Z" level=info msg="starting test case #74"
time="2021-03-27T16:19:34Z" level=info msg="cluster state reset"
time="2021-03-27T16:19:37Z" level=info msg="cluster state verified"
time="2021-03-27T16:19:37Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:19:52Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:19:52Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that doesn't match its protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-udp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:20:16Z" level=info msg="finished policy #74"
time="2021-03-27T16:20:16Z" level=info msg="starting test case #75"
time="2021-03-27T16:20:19Z" level=info msg="cluster state reset"
time="2021-03-27T16:20:22Z" level=info msg="cluster state verified"
time="2021-03-27T16:20:22Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:20:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:20:37Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-7981-udp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-7981-udp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:21:01Z" level=info msg="finished policy #75"
time="2021-03-27T16:21:01Z" level=info msg="starting test case #76"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:21:04Z" level=info msg="cluster state reset"
time="2021-03-27T16:21:07Z" level=info msg="cluster state verified"
time="2021-03-27T16:21:07Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:21:22Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:21:22Z" level=info msg="running kube probe on try 1"
evaluating test case: open a numbered port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 7981 on protocol TCP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 7981
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:21:46Z" level=info msg="finished policy #76"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
time="2021-03-27T16:21:46Z" level=info msg="starting test case #77"
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:21:49Z" level=info msg="cluster state reset"
time="2021-03-27T16:21:52Z" level=info msg="cluster state verified"
time="2021-03-27T16:21:52Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:22:07Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:22:07Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 | port 80 on protocol TCP   |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    - port: 80
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
time="2021-03-27T16:22:30Z" level=info msg="finished policy #77"
time="2021-03-27T16:22:30Z" level=info msg="starting test case #78"
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:22:33Z" level=info msg="cluster state reset"
time="2021-03-27T16:22:36Z" level=info msg="cluster state verified"
time="2021-03-27T16:22:36Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:22:51Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:22:51Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,multi-port/protocol,named-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP         |
|         |               |              |   ns In [y z]                 | port serve-80-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    - port: serve-80-tcp
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:23:14Z" level=info msg="finished policy #78"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:23:14Z" level=info msg="starting test case #79"
time="2021-03-27T16:23:17Z" level=info msg="cluster state reset"
time="2021-03-27T16:23:20Z" level=info msg="cluster state verified"
time="2021-03-27T16:23:20Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:23:35Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:23:35Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,multi-port/protocol,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 | all ports on protocol UDP |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    - protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:23:57Z" level=info msg="finished policy #79"
time="2021-03-27T16:23:57Z" level=info msg="starting test case #80"
time="2021-03-27T16:24:00Z" level=info msg="cluster state reset"
time="2021-03-27T16:24:03Z" level=info msg="cluster state verified"
time="2021-03-27T16:24:03Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:24:18Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:24:18Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 | port 81 on protocol TCP |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    - port: 81
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:24:42Z" level=info msg="finished policy #80"
time="2021-03-27T16:24:42Z" level=info msg="starting test case #81"
time="2021-03-27T16:24:45Z" level=info msg="cluster state reset"
time="2021-03-27T16:24:48Z" level=info msg="cluster state verified"
time="2021-03-27T16:24:48Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:25:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:25:03Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,named-port,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 | port serve-81-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    - port: serve-81-tcp
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:25:25Z" level=info msg="finished policy #81"
time="2021-03-27T16:25:25Z" level=info msg="starting test case #82"
time="2021-03-27T16:25:28Z" level=info msg="cluster state reset"
time="2021-03-27T16:25:31Z" level=info msg="cluster state verified"
time="2021-03-27T16:25:31Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:25:46Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:25:46Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    - port: serve-81-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:26:09Z" level=info msg="finished policy #82"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:26:09Z" level=info msg="starting test case #83"
time="2021-03-27T16:26:12Z" level=info msg="cluster state reset"
time="2021-03-27T16:26:15Z" level=info msg="cluster state verified"
time="2021-03-27T16:26:15Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:26:30Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:26:30Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP           |
|         |               |              |   ns In [y z]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: UDP
    - port: serve-81-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:26:53Z" level=info msg="finished policy #83"
time="2021-03-27T16:26:53Z" level=info msg="starting test case #84"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:26:56Z" level=info msg="cluster state reset"
time="2021-03-27T16:26:59Z" level=info msg="cluster state verified"
time="2021-03-27T16:26:59Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:27:14Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:27:14Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 | port 80 on protocol TCP   |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
    - port: 80
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:27:37Z" level=info msg="finished policy #84"
time="2021-03-27T16:27:37Z" level=info msg="starting test case #85"
time="2021-03-27T16:27:40Z" level=info msg="cluster state reset"
time="2021-03-27T16:27:43Z" level=info msg="cluster state verified"
time="2021-03-27T16:27:43Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:27:58Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:27:58Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,multi-port/protocol,named-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP         |
|         |               |              |   ns In [x y]                 | port serve-80-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
    - port: serve-80-tcp
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:28:21Z" level=info msg="finished policy #85"
time="2021-03-27T16:28:21Z" level=info msg="starting test case #86"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:28:24Z" level=info msg="cluster state reset"
time="2021-03-27T16:28:27Z" level=info msg="cluster state verified"
time="2021-03-27T16:28:27Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:28:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:28:42Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,multi-port/protocol,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 | all ports on protocol UDP |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
    - protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:29:05Z" level=info msg="finished policy #86"
time="2021-03-27T16:29:05Z" level=info msg="starting test case #87"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:29:08Z" level=info msg="cluster state reset"
time="2021-03-27T16:29:11Z" level=info msg="cluster state verified"
time="2021-03-27T16:29:11Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:29:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:29:26Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 | port 81 on protocol TCP |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
    - port: 81
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:29:49Z" level=info msg="finished policy #87"
time="2021-03-27T16:29:49Z" level=info msg="starting test case #88"
time="2021-03-27T16:29:52Z" level=info msg="cluster state reset"
time="2021-03-27T16:29:55Z" level=info msg="cluster state verified"
time="2021-03-27T16:29:55Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:30:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:30:10Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,named-port,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 | port serve-81-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
    - port: serve-81-tcp
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:30:33Z" level=info msg="finished policy #88"
time="2021-03-27T16:30:33Z" level=info msg="starting test case #89"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:30:36Z" level=info msg="cluster state reset"
time="2021-03-27T16:30:39Z" level=info msg="cluster state verified"
time="2021-03-27T16:30:39Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:30:54Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:30:54Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:31:17Z" level=info msg="finished policy #89"
time="2021-03-27T16:31:17Z" level=info msg="starting test case #90"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:31:20Z" level=info msg="cluster state reset"
time="2021-03-27T16:31:23Z" level=info msg="cluster state verified"
time="2021-03-27T16:31:23Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:31:38Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:31:38Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP           |
|         |               |              |   ns In [x y]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: UDP
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:32:00Z" level=info msg="finished policy #90"
time="2021-03-27T16:32:00Z" level=info msg="starting test case #91"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:32:03Z" level=info msg="cluster state reset"
time="2021-03-27T16:32:06Z" level=info msg="cluster state verified"
time="2021-03-27T16:32:06Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:32:21Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:32:21Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:32:44Z" level=info msg="step 2: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:32:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:33:00Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/delete policy
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+------+--------+--------------+------+---------------+
| TYPE | TARGET | SOURCE RULES | PEER | PORT/PROTOCOL |
+------+--------+--------------+------+---------------+
|      |        |              |      |               |
+------+--------+--------------+------+---------------+



Results for network policies:
no network policies
0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:33:22Z" level=info msg="finished policy #91"
time="2021-03-27T16:33:22Z" level=info msg="starting test case #92"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:33:25Z" level=info msg="cluster state reset"
time="2021-03-27T16:33:28Z" level=info msg="cluster state verified"
time="2021-03-27T16:33:28Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:33:43Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:33:43Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:34:06Z" level=info msg="step 2: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:34:21Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:34:21Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/update policy
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol UDP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+                                   +
|         |               |              | namespace: all                |                                   |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:34:44Z" level=info msg="finished policy #92"
time="2021-03-27T16:34:44Z" level=info msg="starting test case #93"
time="2021-03-27T16:34:47Z" level=info msg="cluster state reset"
time="2021-03-27T16:34:50Z" level=info msg="cluster state verified"
time="2021-03-27T16:34:50Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:35:05Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:35:05Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:35:38Z" level=info msg="step 2: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:35:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:35:53Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:36:27Z" level=info msg="step 3: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:36:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:36:42Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/delete namespace
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 121 correct
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y-2/A | Y-2/B | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |       |       |     |     |     |     |     |     |
| UDP/80 |     |     |     |       |       |     |     |     |     |     |     |
| UDP/81 |     |     |     |       |       |     |     |     |     |     |     |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .     | .     | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y-2/a  | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y-2/b  | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:37:05Z" level=info msg="finished policy #93"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T16:37:05Z" level=info msg="starting test case #94"
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:37:07Z" level=info msg="cluster state reset"
time="2021-03-27T16:37:10Z" level=info msg="cluster state verified"
time="2021-03-27T16:37:10Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:37:25Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:37:25Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:37:49Z" level=info msg="step 2: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:38:04Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:38:04Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:38:28Z" level=info msg="step 3: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:38:43Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:38:43Z" level=info msg="running kube probe on try 1"
evaluating test case: Update namespace so that policy applies, then again so it no longer applies
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   new-ns: qrs                 |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          new-ns: qrs
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   new-ns: qrs                 |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          new-ns: qrs
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   new-ns: qrs                 |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          new-ns: qrs
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:39:06Z" level=info msg="finished policy #94"
time="2021-03-27T16:39:06Z" level=info msg="starting test case #95"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:39:09Z" level=info msg="cluster state reset"
time="2021-03-27T16:39:12Z" level=info msg="cluster state verified"
time="2021-03-27T16:39:12Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:39:27Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:39:27Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:39:55Z" level=info msg="step 2: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:40:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:40:11Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:40:40Z" level=info msg="step 3: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:40:55Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:40:55Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/delete pod
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 100 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | X/D | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/d    | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:41:18Z" level=info msg="finished policy #95"
time="2021-03-27T16:41:18Z" level=info msg="starting test case #96"
time="2021-03-27T16:41:21Z" level=info msg="cluster state reset"
time="2021-03-27T16:41:24Z" level=info msg="cluster state verified"
time="2021-03-27T16:41:24Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:41:39Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:41:39Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:42:03Z" level=info msg="step 2: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:42:18Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:42:18Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:42:41Z" level=info msg="step 3: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:42:56Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:42:56Z" level=info msg="running kube probe on try 1"
evaluating test case: Update pod so that policy applies, then again so it no longer applies
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   new-label: abc              |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchLabels:
          new-label: abc
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   new-label: abc              |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchLabels:
          new-label: abc
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   new-label: abc              |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchLabels:
          new-label: abc
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:43:20Z" level=info msg="finished policy #96"
time="2021-03-27T16:43:20Z" level=info msg="starting test case #97"
time="2021-03-27T16:43:23Z" level=info msg="cluster state reset"
time="2021-03-27T16:43:26Z" level=info msg="cluster state verified"
time="2021-03-27T16:43:26Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:43:41Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:43:41Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all from source, allow all to dest
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |    SOURCE RULES     |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+---------------------+-------------------+--------------------------+
| Ingress | namespace: y  | y/allow-all-ingress | all pods, all ips | all ports, all protocols |
|         | Match labels: |                     |                   |                          |
|         |   pod: c      |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+
|         |               |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+
| Egress  | namespace: x  | x/deny-all-egress   | ports for all IPs | port 53 on protocol UDP  |
|         | Match labels: | x/allow-dns         |                   |                          |
|         |   pod: b      |                     |                   |                          |
+         +               +                     +-------------------+                          +
|         |               |                     | namespace: all    |                          |
|         |               |                     | pods: all         |                          |
|         |               |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress
  namespace: "y"
spec:
  ingress:
  - {}
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:44:05Z" level=info msg="finished policy #97"
time="2021-03-27T16:44:05Z" level=info msg="starting test case #98"
time="2021-03-27T16:44:07Z" level=info msg="cluster state reset"
time="2021-03-27T16:44:10Z" level=info msg="cluster state verified"
time="2021-03-27T16:44:10Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:44:25Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:44:25Z" level=info msg="running kube probe on try 1"
evaluating test case: allow all from source, deny all to dest
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |    SOURCE RULES    |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+--------------------+-------------------+--------------------------+
| Ingress | namespace: y  | y/deny-all-ingress | no pods, no ips   | no ports, no protocols   |
|         | Match labels: |                    |                   |                          |
|         |   pod: c      |                    |                   |                          |
+---------+---------------+--------------------+-------------------+--------------------------+
|         |               |                    |                   |                          |
+---------+---------------+--------------------+-------------------+--------------------------+
| Egress  | namespace: x  | x/allow-all-egress | all pods, all ips | all ports, all protocols |
|         | Match labels: | x/allow-dns        |                   |                          |
|         |   pod: b      |                    |                   |                          |
+---------+---------------+--------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress
  namespace: x
spec:
  egress:
  - {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: "y"
spec:
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:44:49Z" level=info msg="finished policy #98"
time="2021-03-27T16:44:49Z" level=info msg="starting test case #99"
time="2021-03-27T16:44:52Z" level=info msg="cluster state reset"
time="2021-03-27T16:44:55Z" level=info msg="cluster state verified"
time="2021-03-27T16:44:55Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:45:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:45:10Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+--------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |    SOURCE RULES    |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+--------------------+-------------------+--------------------------+
|        |               |                    |                   |                          |
+--------+---------------+--------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress  | all pods, all ips | all ports, all protocols |
|        | Match labels: | x/allow-all-egress |                   |                          |
|        |   pod: b      | x/allow-dns        |                   |                          |
+--------+---------------+--------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress
  namespace: x
spec:
  egress:
  - {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:45:32Z" level=info msg="finished policy #99"
time="2021-03-27T16:45:32Z" level=info msg="starting test case #100"
time="2021-03-27T16:45:35Z" level=info msg="cluster state reset"
time="2021-03-27T16:45:38Z" level=info msg="cluster state verified"
time="2021-03-27T16:45:38Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:45:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:45:53Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all to same dest
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |    SOURCE RULES     |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+---------------------+-------------------+--------------------------+
| Ingress | namespace: y  | y/deny-all-ingress  | all pods, all ips | all ports, all protocols |
|         | Match labels: | y/allow-all-ingress |                   |                          |
|         |   pod: c      |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+
|         |               |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: "y"
spec:
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress
  namespace: "y"
spec:
  ingress:
  - {}
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:46:16Z" level=info msg="finished policy #100"
time="2021-03-27T16:46:16Z" level=info msg="starting test case #101"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:46:19Z" level=info msg="cluster state reset"
time="2021-03-27T16:46:22Z" level=info msg="cluster state verified"
time="2021-03-27T16:46:22Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:46:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:46:37Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by pod from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+---------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+---------------------------+-------------------+--------------------------+
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress         | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-pod |                   |                          |
|        |   pod: b      | x/allow-dns               |                   |                          |
+        +               +                           +-------------------+--------------------------+
|        |               |                           | all pods          | all ports, all protocols |
|        |               |                           |                   |                          |
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-pod
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:46:59Z" level=info msg="finished policy #101"
time="2021-03-27T16:46:59Z" level=info msg="starting test case #102"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:47:02Z" level=info msg="cluster state reset"
time="2021-03-27T16:47:05Z" level=info msg="cluster state verified"
time="2021-03-27T16:47:05Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:47:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:47:20Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by IP from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+--------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES       |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+--------------------------+-------------------+--------------------------+
|        |               |                          |                   |                          |
+--------+---------------+--------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress        | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-ip |                   |                          |
|        |   pod: b      | x/allow-dns              |                   |                          |
+        +               +                          +-------------------+--------------------------+
|        |               |                          | 0.0.0.0/0         | all ports, all protocols |
|        |               |                          | except []         |                          |
|        |               |                          |                   |                          |
+        +               +                          +-------------------+--------------------------+
|        |               |                          | namespace: all    | port 53 on protocol UDP  |
|        |               |                          | pods: all         |                          |
|        |               |                          |                   |                          |
+--------+---------------+--------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:47:42Z" level=info msg="finished policy #102"
time="2021-03-27T16:47:42Z" level=info msg="starting test case #103"
time="2021-03-27T16:47:45Z" level=info msg="cluster state reset"
time="2021-03-27T16:47:48Z" level=info msg="cluster state verified"
time="2021-03-27T16:47:48Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:48:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:48:03Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by IP + allow all by pod from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+---------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+---------------------------+-------------------+--------------------------+
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-ip   | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-pod |                   |                          |
|        |   pod: b      | x/allow-dns               |                   |                          |
+        +               +                           +-------------------+--------------------------+
|        |               |                           | 0.0.0.0/31        | all ports, all protocols |
|        |               |                           | except []         |                          |
|        |               |                           |                   |                          |
+        +               +                           +-------------------+                          +
|        |               |                           | all pods          |                          |
|        |               |                           |                   |                          |
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-pod
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:48:26Z" level=info msg="finished policy #103"
time="2021-03-27T16:48:26Z" level=info msg="starting test case #104"
time="2021-03-27T16:48:29Z" level=info msg="cluster state reset"
time="2021-03-27T16:48:32Z" level=info msg="cluster state verified"
time="2021-03-27T16:48:32Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:48:47Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:48:47Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by pod + allow all by IP from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+--------------------------+----------------------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES       |               PEER               |      PORT/PROTOCOL       |
+--------+---------------+--------------------------+----------------------------------+--------------------------+
|        |               |                          |                                  |                          |
+--------+---------------+--------------------------+----------------------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-pod | ports for all IPs                | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-ip |                                  |                          |
|        |   pod: b      | x/allow-dns              |                                  |                          |
+        +               +                          +----------------------------------+--------------------------+
|        |               |                          | 0.0.0.0/0                        | all ports, all protocols |
|        |               |                          | except []                        |                          |
|        |               |                          |                                  |                          |
+        +               +                          +----------------------------------+                          +
|        |               |                          | namespace: Match labels:         |                          |
|        |               |                          |   this-will-never-happen: qrs123 |                          |
|        |               |                          | pods: all                        |                          |
+        +               +                          +----------------------------------+--------------------------+
|        |               |                          | namespace: all                   | port 53 on protocol UDP  |
|        |               |                          | pods: all                        |                          |
|        |               |                          |                                  |                          |
+--------+---------------+--------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-pod
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:49:09Z" level=info msg="finished policy #104"
time="2021-03-27T16:49:09Z" level=info msg="starting test case #105"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:49:12Z" level=info msg="cluster state reset"
time="2021-03-27T16:49:15Z" level=info msg="cluster state verified"
time="2021-03-27T16:49:15Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:49:30Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:49:30Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by pod to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+----------------------------+----------+--------------------------+
|  TYPE   |    TARGET     |        SOURCE RULES        |   PEER   |      PORT/PROTOCOL       |
+---------+---------------+----------------------------+----------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress         | no ips   | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-pod |          |                          |
|         |   pod: b      |                            |          |                          |
+         +               +                            +----------+--------------------------+
|         |               |                            | all pods | all ports, all protocols |
|         |               |                            |          |                          |
|         |               |                            |          |                          |
+---------+---------------+----------------------------+----------+--------------------------+
|         |               |                            |          |                          |
+---------+---------------+----------------------------+----------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-pod
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T16:49:51Z" level=info msg="finished policy #105"
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:49:51Z" level=info msg="starting test case #106"
time="2021-03-27T16:49:54Z" level=info msg="cluster state reset"
time="2021-03-27T16:49:57Z" level=info msg="cluster state verified"
time="2021-03-27T16:49:57Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:50:12Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:50:12Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by IP to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+---------------------------+-------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress        | ports for all IPs | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-ip |                   |                          |
|         |   pod: b      |                           |                   |                          |
+         +               +                           +-------------------+--------------------------+
|         |               |                           | 0.0.0.0/0         | all ports, all protocols |
|         |               |                           | except []         |                          |
|         |               |                           |                   |                          |
+         +               +                           +-------------------+--------------------------+
|         |               |                           | no pods           | no ports, no protocols   |
|         |               |                           |                   |                          |
|         |               |                           |                   |                          |
+---------+---------------+---------------------------+-------------------+--------------------------+
|         |               |                           |                   |                          |
+---------+---------------+---------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:50:38Z" level=info msg="finished policy #106"
time="2021-03-27T16:50:38Z" level=info msg="starting test case #107"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:50:41Z" level=info msg="cluster state reset"
time="2021-03-27T16:50:44Z" level=info msg="cluster state verified"
time="2021-03-27T16:50:44Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:50:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:50:59Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by IP + allow all by pod to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+----------------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |        SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+----------------------------+-------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-ip   | ports for all IPs | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-pod |                   |                          |
|         |   pod: b      |                            |                   |                          |
+         +               +                            +-------------------+--------------------------+
|         |               |                            | 0.0.0.0/31        | all ports, all protocols |
|         |               |                            | except []         |                          |
|         |               |                            |                   |                          |
+         +               +                            +-------------------+                          +
|         |               |                            | all pods          |                          |
|         |               |                            |                   |                          |
|         |               |                            |                   |                          |
+---------+---------------+----------------------------+-------------------+--------------------------+
|         |               |                            |                   |                          |
+---------+---------------+----------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-pod
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:51:21Z" level=info msg="finished policy #107"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:51:21Z" level=info msg="starting test case #108"
time="2021-03-27T16:51:24Z" level=info msg="cluster state reset"
time="2021-03-27T16:51:27Z" level=info msg="cluster state verified"
time="2021-03-27T16:51:27Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:51:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:51:42Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by pod + allow all by IP to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------------+----------------------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES        |               PEER               |      PORT/PROTOCOL       |
+---------+---------------+---------------------------+----------------------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-pod | ports for all IPs                | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-ip |                                  |                          |
|         |   pod: b      |                           |                                  |                          |
+         +               +                           +----------------------------------+--------------------------+
|         |               |                           | 0.0.0.0/0                        | all ports, all protocols |
|         |               |                           | except []                        |                          |
|         |               |                           |                                  |                          |
+         +               +                           +----------------------------------+                          +
|         |               |                           | namespace: Match labels:         |                          |
|         |               |                           |   this-will-never-happen: qrs123 |                          |
|         |               |                           | pods: all                        |                          |
+---------+---------------+---------------------------+----------------------------------+--------------------------+
|         |               |                           |                                  |                          |
+---------+---------------+---------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-pod
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:52:04Z" level=info msg="finished policy #108"
time="2021-03-27T16:52:04Z" level=info msg="starting test case #109"
time="2021-03-27T16:52:07Z" level=info msg="cluster state reset"
time="2021-03-27T16:52:10Z" level=info msg="cluster state verified"
time="2021-03-27T16:52:10Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:52:25Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:52:25Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: deny all by IP
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+-------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |      SOURCE RULES       |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+-------------------------+-------------------+--------------------------+
|        |               |                         |                   |                          |
+--------+---------------+-------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-ip | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-dns             |                   |                          |
|        |   pod: b      |                         |                   |                          |
+        +               +                         +-------------------+--------------------------+
|        |               |                         | 0.0.0.0/31        | all ports, all protocols |
|        |               |                         | except []         |                          |
|        |               |                         |                   |                          |
+        +               +                         +-------------------+--------------------------+
|        |               |                         | namespace: all    | port 53 on protocol UDP  |
|        |               |                         | pods: all         |                          |
|        |               |                         |                   |                          |
+--------+---------------+-------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:52:47Z" level=info msg="finished policy #109"
time="2021-03-27T16:52:47Z" level=info msg="starting test case #110"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:52:50Z" level=info msg="cluster state reset"
time="2021-03-27T16:52:53Z" level=info msg="cluster state verified"
time="2021-03-27T16:52:53Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:53:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:53:08Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: deny all by pod
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+-------------------------+----------------------------------+--------------------------+
|  TYPE  |    TARGET     |      SOURCE RULES       |               PEER               |      PORT/PROTOCOL       |
+--------+---------------+-------------------------+----------------------------------+--------------------------+
|        |               |                         |                                  |                          |
+--------+---------------+-------------------------+----------------------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-ip | ports for all IPs                | port 53 on protocol UDP  |
|        | Match labels: | x/allow-dns             |                                  |                          |
|        |   pod: b      |                         |                                  |                          |
+        +               +                         +----------------------------------+                          +
|        |               |                         | namespace: all                   |                          |
|        |               |                         | pods: all                        |                          |
|        |               |                         |                                  |                          |
+        +               +                         +----------------------------------+--------------------------+
|        |               |                         | namespace: Match labels:         | all ports, all protocols |
|        |               |                         |   this-will-never-happen: qrs123 |                          |
|        |               |                         | pods: all                        |                          |
+--------+---------------+-------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|        | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
time="2021-03-27T16:53:32Z" level=info msg="finished policy #110"
time="2021-03-27T16:53:32Z" level=info msg="starting test case #111"



time="2021-03-27T16:53:35Z" level=info msg="cluster state reset"
time="2021-03-27T16:53:38Z" level=info msg="cluster state verified"
time="2021-03-27T16:53:38Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:53:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:53:53Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: deny all by IP
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES       |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+--------------------------+-------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-ip | ports for all IPs | no ports, no protocols   |
|         | Match labels: |                          |                   |                          |
|         |   pod: b      |                          |                   |                          |
+         +               +                          +-------------------+--------------------------+
|         |               |                          | 0.0.0.0/31        | all ports, all protocols |
|         |               |                          | except []         |                          |
|         |               |                          |                   |                          |
+         +               +                          +-------------------+--------------------------+
|         |               |                          | no pods           | no ports, no protocols   |
|         |               |                          |                   |                          |
|         |               |                          |                   |                          |
+---------+---------------+--------------------------+-------------------+--------------------------+
|         |               |                          |                   |                          |
+---------+---------------+--------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:54:16Z" level=info msg="finished policy #111"
time="2021-03-27T16:54:16Z" level=info msg="starting test case #112"
time="2021-03-27T16:54:18Z" level=info msg="cluster state reset"
time="2021-03-27T16:54:21Z" level=info msg="cluster state verified"
time="2021-03-27T16:54:21Z" level=info msg="step 1: waiting 15.000000 seconds for perturbation to take effect"
time="2021-03-27T16:54:36Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:54:36Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: deny all by pod
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------------------+----------------------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES       |               PEER               |      PORT/PROTOCOL       |
+---------+---------------+--------------------------+----------------------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-ip | no ips                           | no ports, no protocols   |
|         | Match labels: |                          |                                  |                          |
|         |   pod: b      |                          |                                  |                          |
+         +               +                          +----------------------------------+--------------------------+
|         |               |                          | namespace: Match labels:         | all ports, all protocols |
|         |               |                          |   this-will-never-happen: qrs123 |                          |
|         |               |                          | pods: all                        |                          |
+---------+---------------+--------------------------+----------------------------------+--------------------------+
|         |               |                          |                                  |                          |
+---------+---------------+--------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:54:59Z" level=info msg="finished policy #112"
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| TCP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| TCP/81 |     |     |     |     |     |     |     |     |     |
| UDP/80 |     |     |     |     |     |     |     |     |     |
| UDP/81 |     |     |     |     |     |     |     |     |     |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c    | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|        | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



Summary:
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                           TEST                                            | RESULT |   STEP/TRY    | WRONG | RIGHT | IGNORED |       TCP        | SCTP |       UDP        |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 1: set namespace to x                                                                     | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 2: set namespace to y                                                                     | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 3: set namespace to z                                                                     | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 4: set pod selector to                                                                    | passed |               |       |       |         |                  |      |                  |
| ["MatchLabels",null,"MatchExpression",null]                                               |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 5: set pod selector to                                                                    | passed |               |       |       |         |                  |      |                  |
| ["MatchLabels",["pod:                                                                     |        |               |       |       |         |                  |      |                  |
| a"],"MatchExpression",null]                                                               |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 6: set pod selector to                                                                    | passed |               |       |       |         |                  |      |                  |
| ["MatchLabels",null,"MatchExpression",[{"key":"pod","operator":"In","values":["a","b"]}]] |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 7: egress: deny all                                                                       | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 8: egress: allow all                                                                      | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 9: ingress: deny all                                                                      | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 10: ingress: allow all                                                                    | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 11: ingress: empty peers                                                                  | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 12: egress: empty peers                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 13: empty pods + nil ns                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 14: pods by label + nil ns                                                                | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 15: nil pods + empty ns                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 16: empty pods + empty ns                                                                 | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 17: pods by label + empty ns                                                              | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 18: nil pods + ns by label                                                                | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 19: empty pods + ns by label                                                              | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 20: pods by label + ns by                                                                 | passed |               |       |       |         |                  |      |                  |
| label                                                                                     |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 21: simple ipblock                                                                        | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     1 |    80 |       0 | 161 / 162 (99%)  | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 2 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 22: ipblock with except                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 23: empty pods + nil ns                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 24: pods by label + nil ns                                                                | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 25: nil pods + empty ns                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 26: empty pods + empty ns                                                                 | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 27: pods by label + empty ns                                                              | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 28: nil pods + ns by label                                                                | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 29: empty pods + ns by label                                                              | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 30: pods by label + ns by                                                                 | passed |               |       |       |         |                  |      |                  |
| label                                                                                     |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 31: simple ipblock                                                                        | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 32: ipblock with except                                                                   | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 33: egress: empty                                                                         | passed |               |       |       |         |                  |      |                  |
| port/protocol                                                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 34: ingress: empty                                                                        | passed |               |       |       |         |                  |      |                  |
| port/protocol                                                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 35:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,port                                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 36:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port                                                       |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 37:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port                                                       |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 38:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,port,protocol,tcp                                               |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 39:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port,protocol,tcp                                          |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 40:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port,protocol,tcp                                          |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 41:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,port,protocol,udp                                               |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 42:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port,protocol,udp                                          |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 43:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port,protocol,udp                                          |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 44:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,port,protocol,sctp                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 45:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port,protocol,sctp                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 46:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,numbered-port,port,protocol,sctp                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 47:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,named-port,port,protocol,tcp                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 48:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,named-port,port,protocol,tcp                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 49:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,named-port,port,protocol,udp                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 50:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,named-port,port,protocol,udp                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 51:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,named-port,port,protocol,sctp                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 52:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,named-port,port,protocol,sctp                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 53: open a named port that                                                                | passed |               |       |       |         |                  |      |                  |
| doesn't match its protocol                                                                |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 54: open a named port that                                                                | passed |               |       |       |         |                  |      |                  |
| isn't served                                                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 55: open a numbered port that                                                             | passed |               |       |       |         |                  |      |                  |
| isn't served                                                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 56:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,port                                                           |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 57:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port                                                      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 58:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port                                                      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 59:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,port,protocol,tcp                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 60:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port,protocol,tcp                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 61:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port,protocol,tcp                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 62:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,port,protocol,udp                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 63:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port,protocol,udp                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 64:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port,protocol,udp                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 65:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,port,protocol,sctp                                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 66:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port,protocol,sctp                                        |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 67:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,numbered-port,port,protocol,sctp                                        |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 68:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,named-port,port,protocol,tcp                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 69:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,named-port,port,protocol,tcp                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 70:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,named-port,port,protocol,udp                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 71:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,named-port,port,protocol,udp                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 72:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,named-port,port,protocol,sctp                                           |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 73:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,named-port,port,protocol,sctp                                           |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 74: open a named port that                                                                | passed |               |       |       |         |                  |      |                  |
| doesn't match its protocol                                                                |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 75: open a named port that                                                                | passed |               |       |       |         |                  |      |                  |
| isn't served                                                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 76: open a numbered port that                                                             | passed |               |       |       |         |                  |      |                  |
| isn't served                                                                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 77:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,multi-port/protocol,numbered-port,port,rule                     |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 78:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,multi-port/protocol,named-port,port,rule                        |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 79:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,egress,multi-port/protocol,port,protocol,rule,udp                      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 80:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,multi-port/protocol,numbered-port,port,rule                              |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 81:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,multi-port/protocol,named-port,numbered-port,port,rule                   |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 82:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 83:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 84:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,multi-port/protocol,numbered-port,port,rule                    |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 85:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,multi-port/protocol,named-port,port,rule                       |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 86:                                                                                       | passed |               |       |       |         |                  |      |                  |
| any-port,direction,ingress,multi-port/protocol,port,protocol,rule,udp                     |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 87:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,multi-port/protocol,numbered-port,port,rule                             |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 88:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,multi-port/protocol,named-port,numbered-port,port,rule                  |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 89:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp     |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 90:                                                                                       | passed |               |       |       |         |                  |      |                  |
| direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp     |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 91: Create/delete policy                                                                  | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 92: Create/update policy                                                                  | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 93: Create/delete namespace                                                               | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |   121 |       0 | 242 / 242 (100%) | -    | 242 / 242 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 94: Update namespace so that                                                              | passed |               |       |       |         |                  |      |                  |
| policy applies, then again so                                                             |        |               |       |       |         |                  |      |                  |
| it no longer applies                                                                      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 95: Create/delete pod                                                                     | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |   100 |       0 | 200 / 200 (100%) | -    | 200 / 200 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 96: Update pod so that policy                                                             | passed |               |       |       |         |                  |      |                  |
| applies, then again so it no                                                              |        |               |       |       |         |                  |      |                  |
| longer applies                                                                            |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 97: deny all from source,                                                                 | passed |               |       |       |         |                  |      |                  |
| allow all to dest                                                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 98: allow all from source,                                                                | passed |               |       |       |         |                  |      |                  |
| deny all to dest                                                                          |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 99: deny all + allow all from                                                             | passed |               |       |       |         |                  |      |                  |
| same source                                                                               |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 100: deny all + allow all to                                                              | passed |               |       |       |         |                  |      |                  |
| same dest                                                                                 |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 101: deny all + allow all by                                                              | passed |               |       |       |         |                  |      |                  |
| pod from same source                                                                      |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 102: deny all + allow all by                                                              | passed |               |       |       |         |                  |      |                  |
| IP from same source                                                                       |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 103: deny all by IP + allow                                                               | passed |               |       |       |         |                  |      |                  |
| all by pod from same source                                                               |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 104: deny all by pod + allow                                                              | passed |               |       |       |         |                  |      |                  |
| all by IP from same source                                                                |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 105: deny all + allow all by                                                              | passed |               |       |       |         |                  |      |                  |
| pod to same source                                                                        |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 106: deny all + allow all by                                                              | passed |               |       |       |         |                  |      |                  |
| IP to same source                                                                         |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 107: deny all by IP + allow                                                               | passed |               |       |       |         |                  |      |                  |
| all by pod to same source                                                                 |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 108: deny all by pod + allow                                                              | passed |               |       |       |         |                  |      |                  |
| all by IP to same source                                                                  |        |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 109: egress: deny all by IP                                                               | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 110: egress: deny all by pod                                                              | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 111: ingress: deny all by IP                                                              | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
| 112: ingress: deny all by pod                                                             | passed |               |       |       |         |                  |      |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | -    | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------+------------------+

peer-pods counts:
+---------------------+--------+--------+----------+
|       FEATURE       | PASSED | FAILED | PASSED % |
+---------------------+--------+--------+----------+
| policy-namespace    |      4 |      0 |      100 |
| all-pods            |     14 |      0 |      100 |
| pods-by-label       |      6 |      0 |      100 |
| all-namespaces      |     10 |      0 |      100 |
| namespaces-by-label |      6 |      0 |      100 |
+---------------------+--------+--------+----------+

port counts:
+---------------+--------+--------+----------+
|    FEATURE    | PASSED | FAILED | PASSED % |
+---------------+--------+--------+----------+
| any-port      |     14 |      0 |      100 |
| numbered-port |     28 |      0 |      100 |
| named-port    |     24 |      0 |      100 |
+---------------+--------+--------+----------+

target counts:
+---------------------+--------+--------+----------+
|       FEATURE       | PASSED | FAILED | PASSED % |
+---------------------+--------+--------+----------+
| target-namespace    |      3 |      0 |      100 |
| target-pod-selector |      3 |      0 |      100 |
+---------------------+--------+--------+----------+

rule counts:
+---------------------+--------+--------+----------+
|       FEATURE       | PASSED | FAILED | PASSED % |
+---------------------+--------+--------+----------+
| any-peer            |      2 |      0 |      100 |
| any-port-protocol   |      2 |      0 |      100 |
| multi-port/protocol |     14 |      0 |      100 |
| deny-all            |     10 |      0 |      100 |
| allow-all           |      6 |      0 |      100 |
+---------------------+--------+--------+----------+

peer-ipblock counts:
+----------------------+--------+--------+----------+
|       FEATURE        | PASSED | FAILED | PASSED % |
+----------------------+--------+--------+----------+
| ip-block-no-except   |      2 |      0 |      100 |
| ip-block-with-except |      2 |      0 |      100 |
+----------------------+--------+--------+----------+

protocol counts:
+---------+--------+--------+----------+
| FEATURE | PASSED | FAILED | PASSED % |
+---------+--------+--------+----------+
| tcp     |     16 |      0 |      100 |
| udp     |     16 |      0 |      100 |
| sctp    |     10 |      0 |      100 |
+---------+--------+--------+----------+

miscellaneous counts:
+--------------+--------+--------+----------+
|   FEATURE    | PASSED | FAILED | PASSED % |
+--------------+--------+--------+----------+
| pathological |      6 |      0 |      100 |
| conflict     |     16 |      0 |      100 |
+--------------+--------+--------+----------+

action counts:
+----------------------+--------+--------+----------+
|       FEATURE        | PASSED | FAILED | PASSED % |
+----------------------+--------+--------+----------+
| create-policy        |      2 |      0 |      100 |
| update-policy        |      1 |      0 |      100 |
| create-namespace     |      1 |      0 |      100 |
| delete-pod           |      1 |      0 |      100 |
| delete-policy        |      1 |      0 |      100 |
| delete-namespace     |      1 |      0 |      100 |
| set-namespace-labels |      1 |      0 |      100 |
| create-pod           |      1 |      0 |      100 |
| set-pod-labels       |      1 |      0 |      100 |
+----------------------+--------+--------+----------+

direction counts:
+---------+--------+--------+----------+
| FEATURE | PASSED | FAILED | PASSED % |
+---------+--------+--------+----------+
| egress  |     51 |      0 |      100 |
| ingress |     51 |      0 |      100 |
+---------+--------+--------+----------+

Pass/Fail for probes on protocols:
+---------------+--------+--------+----------+
|   PROTOCOL    | PASSED | FAILED | PASSED % |
+---------------+--------+--------+----------+
| probe on TCP  |  20043 |      1 |       99 |
| probe on SCTP |      0 |      0 |        0 |
| probe on UDP  |  20044 |      0 |      100 |
+---------------+--------+--------+----------+
```


# Feature results:

| Tag | Result |
| --- | --- |
| action | 112 / 112 = 100%  |
|  - action: create namespace | 1 / 1 = 100%  |
|  - action: create pod | 2 / 2 = 100%  |
|  - action: create policy | 112 / 112 = 100%  |
|  - action: delete namespace | 1 / 1 = 100%  |
|  - action: delete pod | 1 / 1 = 100%  |
|  - action: delete policy | 1 / 1 = 100%  |
|  - action: set namespace labels | 1 / 1 = 100%  |
|  - action: set pod labels | 1 / 1 = 100%  |
|  - action: update policy | 1 / 1 = 100%  |
| egress | 112 / 112 = 100%  |
|  - 0 peers | 104 / 104 = 100%  |
|  - 0 port/protocols | 10 / 10 = 100%  |
|  - 0 rules | 13 / 13 = 100%  |
|  - 1 peer | 99 / 99 = 100%  |
|  - 1 port/protocol | 103 / 103 = 100%  |
|  - 1 rule | 10 / 10 = 100%  |
|  - 2+ port/protocols | 7 / 7 = 100%  |
|  - 2+ rules | 94 / 94 = 100%  |
|  - IPBlock (no except) | 5 / 5 = 100%  |
|  - IPBlock with except | 1 / 1 = 100%  |
|  - all peers on all ports/protocols | 3 / 3 = 100%  |
|  - named port | 12 / 12 = 100%  |
|  - nil port | 7 / 7 = 100%  |
|  - nil protocol | 9 / 9 = 100%  |
|  - numbered port | 103 / 103 = 100%  |
|  - peer namespace selector empty | 5 / 5 = 100%  |
|  - peer namespace selector match expression | 83 / 83 = 100%  |
|  - peer namespace selector match labels | 5 / 5 = 100%  |
|  - peer namespace selector nil | 2 / 2 = 100%  |
|  - peer pod selector empty | 3 / 3 = 100%  |
|  - peer pod selector match expression | 83 / 83 = 100%  |
|  - peer pod selector match labels | 3 / 3 = 100%  |
|  - peer pod selector nil | 6 / 6 = 100%  |
|  - policy on SCTP | 5 / 5 = 100%  |
|  - policy on TCP | 73 / 73 = 100%  |
|  - policy on UDP | 103 / 103 = 100%  |
| general | 112 / 112 = 100%  |
|  - policy with both ingress and egress | 94 / 94 = 100%  |
|  - policy with egress | 104 / 104 = 100%  |
|  - policy with ingress | 103 / 103 = 100%  |
|  - target: empty pod selector | 1 / 1 = 100%  |
|  - target: pod selector match expression | 1 / 1 = 100%  |
|  - target: pod selector match labels | 110 / 110 = 100%  |
|  - target: specific namespace | 112 / 112 = 100%  |
| ingress | 112 / 112 = 100%  |
|  - 0 peers | 4 / 4 = 100%  |
|  - 0 port/protocols | 10 / 10 = 100%  |
|  - 0 rules | 13 / 13 = 100%  |
|  - 1 peer | 99 / 99 = 100%  |
|  - 1 port/protocol | 86 / 86 = 100%  |
|  - 1 rule | 103 / 103 = 100%  |
|  - 2+ port/protocols | 7 / 7 = 100%  |
|  - IPBlock (no except) | 5 / 5 = 100%  |
|  - IPBlock with except | 1 / 1 = 100%  |
|  - all peers on all ports/protocols | 3 / 3 = 100%  |
|  - named port | 13 / 13 = 100%  |
|  - nil port | 7 / 7 = 100%  |
|  - nil protocol | 9 / 9 = 100%  |
|  - numbered port | 79 / 79 = 100%  |
|  - peer namespace selector empty | 5 / 5 = 100%  |
|  - peer namespace selector match expression | 82 / 82 = 100%  |
|  - peer namespace selector match labels | 6 / 6 = 100%  |
|  - peer namespace selector nil | 2 / 2 = 100%  |
|  - peer pod selector empty | 3 / 3 = 100%  |
|  - peer pod selector match expression | 81 / 81 = 100%  |
|  - peer pod selector match labels | 4 / 4 = 100%  |
|  - peer pod selector nil | 7 / 7 = 100%  |
|  - policy on SCTP | 5 / 5 = 100%  |
|  - policy on TCP | 73 / 73 = 100%  |
|  - policy on UDP | 9 / 9 = 100%  |

Tag results:
| Tag | Result |
| --- | --- |
| action | 6 / 6 = 100%  |
|  - create-namespace | 1 / 1 = 100%  |
|  - create-pod | 1 / 1 = 100%  |
|  - create-policy | 2 / 2 = 100%  |
|  - delete-namespace | 1 / 1 = 100%  |
|  - delete-pod | 1 / 1 = 100%  |
|  - delete-policy | 1 / 1 = 100%  |
|  - set-namespace-labels | 1 / 1 = 100%  |
|  - set-pod-labels | 1 / 1 = 100%  |
|  - update-policy | 1 / 1 = 100%  |
| direction | 100 / 100 = 100%  |
|  - egress | 51 / 51 = 100%  |
|  - ingress | 51 / 51 = 100%  |
| miscellaneous | 22 / 22 = 100%  |
|  - conflict | 16 / 16 = 100%  |
|  - pathological | 6 / 6 = 100%  |
| peer-ipblock | 4 / 4 = 100%  |
|  - ip-block-no-except | 2 / 2 = 100%  |
|  - ip-block-with-except | 2 / 2 = 100%  |
| peer-pods | 20 / 20 = 100%  |
|  - all-namespaces | 10 / 10 = 100%  |
|  - all-pods | 14 / 14 = 100%  |
|  - namespaces-by-label | 6 / 6 = 100%  |
|  - pods-by-label | 6 / 6 = 100%  |
|  - policy-namespace | 4 / 4 = 100%  |
| port | 56 / 56 = 100%  |
|  - any-port | 14 / 14 = 100%  |
|  - named-port | 24 / 24 = 100%  |
|  - numbered-port | 28 / 28 = 100%  |
| protocol | 42 / 42 = 100%  |
|  - sctp | 10 / 10 = 100%  |
|  - tcp | 16 / 16 = 100%  |
|  - udp | 16 / 16 = 100%  |
| rule | 30 / 30 = 100%  |
|  - allow-all | 6 / 6 = 100%  |
|  - any-peer | 2 / 2 = 100%  |
|  - any-port-protocol | 2 / 2 = 100%  |
|  - deny-all | 10 / 10 = 100%  |
|  - multi-port/protocol | 14 / 14 = 100%  |
| target | 6 / 6 = 100%  |
|  - target-namespace | 3 / 3 = 100%  |
|  - target-pod-selector | 3 / 3 = 100%  |
