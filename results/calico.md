# Calico Results

The following are the results for calico

```
time="2021-03-27T15:23:10Z" level=info msg="log level set to 'info'"
Version: 0.4.0
Git SHA: 9374a1a7511cfd4e1f1955bbcb46f247b91b0fe2
Build time: 2021-03-27T11:07:15Z
time="2021-03-27T15:23:17Z" level=info msg="waiting for 9 pods to be running and have IP addresses; currently 4 are ready"
resources:
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| NAMESPACE | NS LABELS | POD | POD LABELS |          IPS           |        CONTAINERS/PORTS        |
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| x         | ns: x     | a   | pod: a     | pod: 192.168.96.66     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.214.176 | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | b   | pod: b     | pod: 192.168.193.5     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.218.217 | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | c   | pod: c     | pod: 192.168.96.67     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.165.51  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| y         | ns: y     | a   | pod: a     | pod: 192.168.193.6     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.182.101 | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | b   | pod: b     | pod: 192.168.96.68     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.201.85  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | c   | pod: c     | pod: 192.168.193.7     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.141.204 | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+-----------+-----------+-----+------------+------------------------+--------------------------------+
| z         | ns: z     | a   | pod: a     | pod: 192.168.96.69     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.13.171  | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | b   | pod: b     | pod: 192.168.193.8     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.158.157 | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+           +           +-----+------------+------------------------+--------------------------------+
|           |           | c   | pod: c     | pod: 192.168.193.9     | cont-80-tcp, port              |
|           |           |     |            | service: 10.96.27.88   | serve-80-tcp: 80 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-udp, port              |
|           |           |     |            |                        | serve-80-udp: 80 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-80-sctp, port             |
|           |           |     |            |                        | serve-80-sctp: 80 on SCTP      |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-tcp, port              |
|           |           |     |            |                        | serve-81-tcp: 81 on TCP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-udp, port              |
|           |           |     |            |                        | serve-81-udp: 81 on UDP        |
+           +           +     +            +                        +--------------------------------+
|           |           |     |            |                        | cont-81-sctp, port             |
|           |           |     |            |                        | serve-81-sctp: 81 on SCTP      |
+-----------+-----------+-----+------------+------------------------+--------------------------------+

test cases to run by tag:
- action: 6
- any-peer: 2
- named-port: 24
- rule: 30
- create-pod: 1
- policy-namespace: 4
- ip-block-with-except: 2
- ip-block-no-except: 2
- delete-namespace: 1
- create-policy: 2
- deny-all: 10
- set-namespace-labels: 1
- delete-policy: 1
- allow-all: 6
- create-namespace: 1
- peer-ipblock: 4
- egress: 51
- delete-pod: 1
- multi-port/protocol: 14
- target-namespace: 3
- peer-pods: 20
- conflict: 16
- port: 56
- target-pod-selector: 3
- all-pods: 14
- direction: 100
- protocol: 42
- multi-peer: 0
- ingress: 51
- example: 0
- udp: 16
- numbered-port: 28
- pods-by-label: 6
- namespaces-by-label: 6
- sctp: 10
- tcp: 16
- upstream-e2e: 0
- update-policy: 1
- target: 6
- any-port: 14
- any-port-protocol: 2
- miscellaneous: 22
- set-pod-labels: 1
- pathological: 6
- policy-stack: 0
- all-namespaces: 10
testing 112 cases

time="2021-03-27T15:23:23Z" level=info msg="test #1 to run: set namespace to x"
time="2021-03-27T15:23:23Z" level=info msg="test #2 to run: set namespace to y"
time="2021-03-27T15:23:23Z" level=info msg="test #3 to run: set namespace to z"
time="2021-03-27T15:23:23Z" level=info msg="test #4 to run: set pod selector to [\"MatchLabels\",null,\"MatchExpression\",null]"
time="2021-03-27T15:23:23Z" level=info msg="test #5 to run: set pod selector to [\"MatchLabels\",[\"pod: a\"],\"MatchExpression\",null]"
time="2021-03-27T15:23:23Z" level=info msg="test #6 to run: set pod selector to [\"MatchLabels\",null,\"MatchExpression\",[{\"key\":\"pod\",\"operator\":\"In\",\"values\":[\"a\",\"b\"]}]]"
time="2021-03-27T15:23:23Z" level=info msg="test #7 to run: egress: deny all"
time="2021-03-27T15:23:23Z" level=info msg="test #8 to run: egress: allow all"
time="2021-03-27T15:23:23Z" level=info msg="test #9 to run: ingress: deny all"
time="2021-03-27T15:23:23Z" level=info msg="test #10 to run: ingress: allow all"
time="2021-03-27T15:23:23Z" level=info msg="test #11 to run: ingress: empty peers"
time="2021-03-27T15:23:23Z" level=info msg="test #12 to run: egress: empty peers"
time="2021-03-27T15:23:23Z" level=info msg="test #13 to run: empty pods + nil ns"
time="2021-03-27T15:23:23Z" level=info msg="test #14 to run: pods by label + nil ns"
time="2021-03-27T15:23:23Z" level=info msg="test #15 to run: nil pods + empty ns"
time="2021-03-27T15:23:23Z" level=info msg="test #16 to run: empty pods + empty ns"
time="2021-03-27T15:23:23Z" level=info msg="test #17 to run: pods by label + empty ns"
time="2021-03-27T15:23:23Z" level=info msg="test #18 to run: nil pods + ns by label"
time="2021-03-27T15:23:23Z" level=info msg="test #19 to run: empty pods + ns by label"
time="2021-03-27T15:23:23Z" level=info msg="test #20 to run: pods by label + ns by label"
time="2021-03-27T15:23:23Z" level=info msg="test #21 to run: simple ipblock"
time="2021-03-27T15:23:23Z" level=info msg="test #22 to run: ipblock with except"
time="2021-03-27T15:23:23Z" level=info msg="test #23 to run: empty pods + nil ns"
time="2021-03-27T15:23:23Z" level=info msg="test #24 to run: pods by label + nil ns"
time="2021-03-27T15:23:23Z" level=info msg="test #25 to run: nil pods + empty ns"
time="2021-03-27T15:23:23Z" level=info msg="test #26 to run: empty pods + empty ns"
time="2021-03-27T15:23:23Z" level=info msg="test #27 to run: pods by label + empty ns"
time="2021-03-27T15:23:23Z" level=info msg="test #28 to run: nil pods + ns by label"
time="2021-03-27T15:23:23Z" level=info msg="test #29 to run: empty pods + ns by label"
time="2021-03-27T15:23:23Z" level=info msg="test #30 to run: pods by label + ns by label"
time="2021-03-27T15:23:23Z" level=info msg="test #31 to run: simple ipblock"
time="2021-03-27T15:23:23Z" level=info msg="test #32 to run: ipblock with except"
time="2021-03-27T15:23:23Z" level=info msg="test #33 to run: egress: empty port/protocol"
time="2021-03-27T15:23:23Z" level=info msg="test #34 to run: ingress: empty port/protocol"
time="2021-03-27T15:23:23Z" level=info msg="test #35 to run: any-port,direction,egress,port"
time="2021-03-27T15:23:23Z" level=info msg="test #36 to run: direction,egress,numbered-port,port"
time="2021-03-27T15:23:23Z" level=info msg="test #37 to run: direction,egress,numbered-port,port"
time="2021-03-27T15:23:23Z" level=info msg="test #38 to run: any-port,direction,egress,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #39 to run: direction,egress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #40 to run: direction,egress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #41 to run: any-port,direction,egress,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #42 to run: direction,egress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #43 to run: direction,egress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #44 to run: any-port,direction,egress,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #45 to run: direction,egress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #46 to run: direction,egress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #47 to run: direction,egress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #48 to run: direction,egress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #49 to run: direction,egress,named-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #50 to run: direction,egress,named-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #51 to run: direction,egress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #52 to run: direction,egress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #53 to run: open a named port that doesn't match its protocol"
time="2021-03-27T15:23:23Z" level=info msg="test #54 to run: open a named port that isn't served"
time="2021-03-27T15:23:23Z" level=info msg="test #55 to run: open a numbered port that isn't served"
time="2021-03-27T15:23:23Z" level=info msg="test #56 to run: any-port,direction,ingress,port"
time="2021-03-27T15:23:23Z" level=info msg="test #57 to run: direction,ingress,numbered-port,port"
time="2021-03-27T15:23:23Z" level=info msg="test #58 to run: direction,ingress,numbered-port,port"
time="2021-03-27T15:23:23Z" level=info msg="test #59 to run: any-port,direction,ingress,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #60 to run: direction,ingress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #61 to run: direction,ingress,numbered-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #62 to run: any-port,direction,ingress,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #63 to run: direction,ingress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #64 to run: direction,ingress,numbered-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #65 to run: any-port,direction,ingress,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #66 to run: direction,ingress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #67 to run: direction,ingress,numbered-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #68 to run: direction,ingress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #69 to run: direction,ingress,named-port,port,protocol,tcp"
time="2021-03-27T15:23:23Z" level=info msg="test #70 to run: direction,ingress,named-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #71 to run: direction,ingress,named-port,port,protocol,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #72 to run: direction,ingress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #73 to run: direction,ingress,named-port,port,protocol,sctp"
time="2021-03-27T15:23:23Z" level=info msg="test #74 to run: open a named port that doesn't match its protocol"
time="2021-03-27T15:23:23Z" level=info msg="test #75 to run: open a named port that isn't served"
time="2021-03-27T15:23:23Z" level=info msg="test #76 to run: open a numbered port that isn't served"
time="2021-03-27T15:23:23Z" level=info msg="test #77 to run: any-port,direction,egress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #78 to run: any-port,direction,egress,multi-port/protocol,named-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #79 to run: any-port,direction,egress,multi-port/protocol,port,protocol,rule,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #80 to run: direction,egress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #81 to run: direction,egress,multi-port/protocol,named-port,numbered-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #82 to run: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #83 to run: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #84 to run: any-port,direction,ingress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #85 to run: any-port,direction,ingress,multi-port/protocol,named-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #86 to run: any-port,direction,ingress,multi-port/protocol,port,protocol,rule,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #87 to run: direction,ingress,multi-port/protocol,numbered-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #88 to run: direction,ingress,multi-port/protocol,named-port,numbered-port,port,rule"
time="2021-03-27T15:23:23Z" level=info msg="test #89 to run: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #90 to run: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp"
time="2021-03-27T15:23:23Z" level=info msg="test #91 to run: Create/delete policy"
time="2021-03-27T15:23:23Z" level=info msg="test #92 to run: Create/update policy"
time="2021-03-27T15:23:23Z" level=info msg="test #93 to run: Create/delete namespace"
time="2021-03-27T15:23:23Z" level=info msg="test #94 to run: Update namespace so that policy applies, then again so it no longer applies"
time="2021-03-27T15:23:23Z" level=info msg="test #95 to run: Create/delete pod"
time="2021-03-27T15:23:23Z" level=info msg="test #96 to run: Update pod so that policy applies, then again so it no longer applies"
time="2021-03-27T15:23:23Z" level=info msg="test #97 to run: deny all from source, allow all to dest"
time="2021-03-27T15:23:23Z" level=info msg="test #98 to run: allow all from source, deny all to dest"
time="2021-03-27T15:23:23Z" level=info msg="test #99 to run: deny all + allow all from same source"
time="2021-03-27T15:23:23Z" level=info msg="test #100 to run: deny all + allow all to same dest"
time="2021-03-27T15:23:23Z" level=info msg="test #101 to run: deny all + allow all by pod from same source"
time="2021-03-27T15:23:23Z" level=info msg="test #102 to run: deny all + allow all by IP from same source"
time="2021-03-27T15:23:23Z" level=info msg="test #103 to run: deny all by IP + allow all by pod from same source"
time="2021-03-27T15:23:23Z" level=info msg="test #104 to run: deny all by pod + allow all by IP from same source"
time="2021-03-27T15:23:23Z" level=info msg="test #105 to run: deny all + allow all by pod to same source"
time="2021-03-27T15:23:23Z" level=info msg="test #106 to run: deny all + allow all by IP to same source"
time="2021-03-27T15:23:23Z" level=info msg="test #107 to run: deny all by IP + allow all by pod to same source"
time="2021-03-27T15:23:23Z" level=info msg="test #108 to run: deny all by pod + allow all by IP to same source"
time="2021-03-27T15:23:23Z" level=info msg="test #109 to run: egress: deny all by IP"
time="2021-03-27T15:23:23Z" level=info msg="test #110 to run: egress: deny all by pod"
time="2021-03-27T15:23:23Z" level=info msg="test #111 to run: ingress: deny all by IP"
time="2021-03-27T15:23:23Z" level=info msg="test #112 to run: ingress: deny all by pod"
time="2021-03-27T15:23:23Z" level=info msg="starting test case #1"
time="2021-03-27T15:23:28Z" level=info msg="cluster state reset"
time="2021-03-27T15:23:31Z" level=info msg="cluster state verified"
time="2021-03-27T15:23:31Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:23:36Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:23:36Z" level=info msg="running kube probe on try 1"
evaluating test case: set namespace to x
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
time="2021-03-27T15:24:10Z" level=info msg="finished policy #1"
time="2021-03-27T15:24:10Z" level=info msg="starting test case #2"
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:24:13Z" level=info msg="cluster state reset"
time="2021-03-27T15:24:16Z" level=info msg="cluster state verified"
time="2021-03-27T15:24:16Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:24:21Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:24:21Z" level=info msg="running kube probe on try 1"
evaluating test case: set namespace to y
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: y  | y/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: y  | y/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: "y"
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | X   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:24:53Z" level=info msg="finished policy #2"
time="2021-03-27T15:24:53Z" level=info msg="starting test case #3"
time="2021-03-27T15:24:56Z" level=info msg="cluster state reset"
time="2021-03-27T15:24:59Z" level=info msg="cluster state verified"
time="2021-03-27T15:24:59Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:25:04Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:25:04Z" level=info msg="running kube probe on try 1"
evaluating test case: set namespace to z
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: z  | z/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: z  | z/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: z
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:25:37Z" level=info msg="finished policy #3"
time="2021-03-27T15:25:37Z" level=info msg="starting test case #4"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | X   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | X   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:25:40Z" level=info msg="cluster state reset"
time="2021-03-27T15:25:43Z" level=info msg="cluster state verified"
time="2021-03-27T15:25:43Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:25:48Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:25:48Z" level=info msg="running kube probe on try 1"
evaluating test case: set pod selector to ["MatchLabels",null,"MatchExpression",null]
step 1 on all available ports/protocols:
Policy explanation:
+---------+--------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET    | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+--------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x | x/base       | no ips                        | no ports, no protocols  |
|         | all pods     |              |                               |                         |
+         +              +              +-------------------------------+-------------------------+
|         |              |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |              |              |   ns In [x y]                 |                         |
|         |              |              | pods: Match expressions:      |                         |
|         |              |              |   pod In [b c]                |                         |
+---------+--------------+--------------+-------------------------------+-------------------------+
|         |              |              |                               |                         |
+---------+--------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | all pods     |              |                               |                         |
+         +              +              +-------------------------------+-------------------------+
|         |              |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |              |              |   ns In [y z]                 |                         |
|         |              |              | pods: Match expressions:      |                         |
|         |              |              |   pod In [a b]                |                         |
+         +              +              +-------------------------------+-------------------------+
|         |              |              | namespace: all                | port 53 on protocol UDP |
|         |              |              | pods: all                     |                         |
+---------+--------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:26:26Z" level=info msg="finished policy #4"
time="2021-03-27T15:26:26Z" level=info msg="starting test case #5"
time="2021-03-27T15:26:29Z" level=info msg="cluster state reset"
time="2021-03-27T15:26:32Z" level=info msg="cluster state verified"
time="2021-03-27T15:26:32Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:26:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:26:37Z" level=info msg="running kube probe on try 1"
evaluating test case: set pod selector to ["MatchLabels",["pod: a"],"MatchExpression",null]
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:27:12Z" level=info msg="finished policy #5"
time="2021-03-27T15:27:12Z" level=info msg="starting test case #6"
time="2021-03-27T15:27:14Z" level=info msg="cluster state reset"
time="2021-03-27T15:27:17Z" level=info msg="cluster state verified"
time="2021-03-27T15:27:17Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:27:22Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:27:22Z" level=info msg="running kube probe on try 1"
evaluating test case: set pod selector to ["MatchLabels",null,"MatchExpression",[{"key":"pod","operator":"In","values":["a","b"]}]]
step 1 on all available ports/protocols:
Policy explanation:
+---------+--------------------+--------------+-------------------------------+-------------------------+
|  TYPE   |       TARGET       | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+--------------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x       | x/base       | no ips                        | no ports, no protocols  |
|         | Match expressions: |              |                               |                         |
|         |   pod In [a b]     |              |                               |                         |
+         +                    +              +-------------------------------+-------------------------+
|         |                    |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |                    |              |   ns In [x y]                 |                         |
|         |                    |              | pods: Match expressions:      |                         |
|         |                    |              |   pod In [b c]                |                         |
+---------+--------------------+--------------+-------------------------------+-------------------------+
|         |                    |              |                               |                         |
+---------+--------------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x       | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match expressions: |              |                               |                         |
|         |   pod In [a b]     |              |                               |                         |
+         +                    +              +-------------------------------+                         +
|         |                    |              | namespace: all                |                         |
|         |                    |              | pods: all                     |                         |
|         |                    |              |                               |                         |
+         +                    +              +-------------------------------+-------------------------+
|         |                    |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |                    |              |   ns In [y z]                 |                         |
|         |                    |              | pods: Match expressions:      |                         |
|         |                    |              |   pod In [a b]                |                         |
+---------+--------------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchExpressions:
    - key: pod
      operator: In
      values:
      - a
      - b
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:27:57Z" level=info msg="finished policy #6"
time="2021-03-27T15:27:57Z" level=info msg="starting test case #7"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:28:00Z" level=info msg="cluster state reset"
time="2021-03-27T15:28:03Z" level=info msg="cluster state verified"
time="2021-03-27T15:28:03Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:28:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:28:08Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: deny all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | no pods, no ips               | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:31:29Z" level=info msg="finished policy #7"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:31:29Z" level=info msg="starting test case #8"
time="2021-03-27T15:31:32Z" level=info msg="cluster state reset"
time="2021-03-27T15:31:35Z" level=info msg="cluster state verified"
time="2021-03-27T15:31:35Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:31:40Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:31:40Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: allow all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | all pods, all ips             | all ports, all protocols |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - {}
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:32:12Z" level=info msg="finished policy #8"
time="2021-03-27T15:32:12Z" level=info msg="starting test case #9"
time="2021-03-27T15:32:14Z" level=info msg="cluster state reset"
time="2021-03-27T15:32:17Z" level=info msg="cluster state verified"
time="2021-03-27T15:32:17Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:32:22Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:32:22Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: deny all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no pods, no ips               | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:32:55Z" level=info msg="finished policy #9"
time="2021-03-27T15:32:55Z" level=info msg="starting test case #10"
time="2021-03-27T15:32:58Z" level=info msg="cluster state reset"
time="2021-03-27T15:33:01Z" level=info msg="cluster state verified"
time="2021-03-27T15:33:01Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:33:06Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:33:06Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: allow all
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | all pods, all ips             | all ports, all protocols |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+                          +
|         |               |              | namespace: all                |                          |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - {}
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:33:38Z" level=info msg="finished policy #10"
time="2021-03-27T15:33:38Z" level=info msg="starting test case #11"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:33:41Z" level=info msg="cluster state reset"
time="2021-03-27T15:33:44Z" level=info msg="cluster state verified"
time="2021-03-27T15:33:44Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:33:49Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:33:49Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: empty peers
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | ports for all IPs             | port 80 on protocol TCP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:34:22Z" level=info msg="finished policy #11"
time="2021-03-27T15:34:22Z" level=info msg="starting test case #12"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:34:25Z" level=info msg="cluster state reset"
time="2021-03-27T15:34:28Z" level=info msg="cluster state verified"
time="2021-03-27T15:34:28Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:34:33Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:34:33Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: empty peers
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 80 on protocol TCP |
|         | Match labels: |              |                               | port 53 on protocol UDP |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:35:09Z" level=info msg="finished policy #12"
time="2021-03-27T15:35:09Z" level=info msg="starting test case #13"
time="2021-03-27T15:35:12Z" level=info msg="cluster state reset"
time="2021-03-27T15:35:15Z" level=info msg="cluster state verified"
time="2021-03-27T15:35:15Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:35:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:35:20Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - podSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:35:53Z" level=info msg="finished policy #13"
time="2021-03-27T15:35:53Z" level=info msg="starting test case #14"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:35:56Z" level=info msg="cluster state reset"
time="2021-03-27T15:35:59Z" level=info msg="cluster state verified"
time="2021-03-27T15:35:59Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:36:04Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:36:04Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - podSelector:
        matchLabels:
          pod: c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:36:37Z" level=info msg="finished policy #14"
time="2021-03-27T15:36:37Z" level=info msg="starting test case #15"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:36:39Z" level=info msg="cluster state reset"
time="2021-03-27T15:36:42Z" level=info msg="cluster state verified"
time="2021-03-27T15:36:42Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:36:47Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:36:48Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:37:20Z" level=info msg="finished policy #15"
time="2021-03-27T15:37:20Z" level=info msg="starting test case #16"
time="2021-03-27T15:37:23Z" level=info msg="cluster state reset"
time="2021-03-27T15:37:26Z" level=info msg="cluster state verified"
time="2021-03-27T15:37:26Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:37:31Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:37:31Z" level=info msg="running kube probe on try 1"
time="2021-03-27T15:38:04Z" level=info msg="running kube probe on try 2"
evaluating test case: empty pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector: {}
      podSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:38:37Z" level=info msg="finished policy #16"
time="2021-03-27T15:38:37Z" level=info msg="starting test case #17"
time="2021-03-27T15:38:40Z" level=info msg="cluster state reset"
time="2021-03-27T15:38:43Z" level=info msg="cluster state verified"
time="2021-03-27T15:38:43Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:38:48Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:38:48Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector: {}
      podSelector:
        matchLabels:
          pod: c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:39:21Z" level=info msg="finished policy #17"
time="2021-03-27T15:39:21Z" level=info msg="starting test case #18"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:39:23Z" level=info msg="cluster state reset"
time="2021-03-27T15:39:26Z" level=info msg="cluster state verified"
time="2021-03-27T15:39:26Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:39:31Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:39:32Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          ns: x
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:40:04Z" level=info msg="finished policy #18"
time="2021-03-27T15:40:04Z" level=info msg="starting test case #19"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:40:07Z" level=info msg="cluster state reset"
time="2021-03-27T15:40:10Z" level=info msg="cluster state verified"
time="2021-03-27T15:40:10Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:40:15Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:40:15Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector: {}
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:40:48Z" level=info msg="finished policy #19"
time="2021-03-27T15:40:48Z" level=info msg="starting test case #20"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:40:51Z" level=info msg="cluster state reset"
time="2021-03-27T15:40:54Z" level=info msg="cluster state verified"
time="2021-03-27T15:40:54Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:40:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:40:59Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector:
        matchLabels:
          pod: c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:41:31Z" level=info msg="finished policy #20"
time="2021-03-27T15:41:31Z" level=info msg="starting test case #21"
time="2021-03-27T15:41:34Z" level=info msg="cluster state reset"
time="2021-03-27T15:41:37Z" level=info msg="cluster state verified"
time="2021-03-27T15:41:37Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:41:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:41:42Z" level=info msg="running kube probe on try 1"
evaluating test case: simple ipblock
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | ports for all IPs             | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 192.168.193.9/24              | port 80 on protocol TCP |
|         |               |              | except []                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | no pods                       | no ports, no protocols  |
|         |               |              |                               |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - ipBlock:
        cidr: 192.168.193.9/24
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:42:16Z" level=info msg="finished policy #21"
time="2021-03-27T15:42:16Z" level=info msg="starting test case #22"
time="2021-03-27T15:42:18Z" level=info msg="cluster state reset"
time="2021-03-27T15:42:21Z" level=info msg="cluster state verified"
time="2021-03-27T15:42:21Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:42:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:42:27Z" level=info msg="running kube probe on try 1"
evaluating test case: ipblock with except
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | ports for all IPs             | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 192.168.193.9/24              | port 80 on protocol TCP |
|         |               |              | except [192.168.193.9/28]     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | no pods                       | no ports, no protocols  |
|         |               |              |                               |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - ipBlock:
        cidr: 192.168.193.9/24
        except:
        - 192.168.193.9/28
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:42:59Z" level=info msg="finished policy #22"
time="2021-03-27T15:42:59Z" level=info msg="starting test case #23"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:43:02Z" level=info msg="cluster state reset"
time="2021-03-27T15:43:05Z" level=info msg="cluster state verified"
time="2021-03-27T15:43:05Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:43:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:43:10Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - podSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | .   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:43:42Z" level=info msg="finished policy #23"
time="2021-03-27T15:43:42Z" level=info msg="starting test case #24"
time="2021-03-27T15:43:45Z" level=info msg="cluster state reset"
time="2021-03-27T15:43:48Z" level=info msg="cluster state verified"
time="2021-03-27T15:43:48Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:43:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:43:53Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + nil ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: x                  | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - podSelector:
        matchLabels:
          pod: c
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | .   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:44:26Z" level=info msg="finished policy #24"
time="2021-03-27T15:44:26Z" level=info msg="starting test case #25"
time="2021-03-27T15:44:29Z" level=info msg="cluster state reset"
time="2021-03-27T15:44:32Z" level=info msg="cluster state verified"
time="2021-03-27T15:44:32Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:44:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:44:37Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     | port 53 on protocol UDP |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:45:10Z" level=info msg="finished policy #25"
time="2021-03-27T15:45:10Z" level=info msg="starting test case #26"
time="2021-03-27T15:45:12Z" level=info msg="cluster state reset"
time="2021-03-27T15:45:15Z" level=info msg="cluster state verified"
time="2021-03-27T15:45:15Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:45:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:45:20Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: all                     | port 53 on protocol UDP |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector: {}
      podSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:45:53Z" level=info msg="finished policy #26"
time="2021-03-27T15:45:53Z" level=info msg="starting test case #27"
time="2021-03-27T15:45:55Z" level=info msg="cluster state reset"
time="2021-03-27T15:45:58Z" level=info msg="cluster state verified"
time="2021-03-27T15:45:58Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:46:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:46:04Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + empty ns
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 80 on protocol TCP |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector: {}
      podSelector:
        matchLabels:
          pod: c
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:46:36Z" level=info msg="finished policy #27"
time="2021-03-27T15:46:36Z" level=info msg="starting test case #28"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | .   | X   | X   | .   | X   | X   | .   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:46:39Z" level=info msg="cluster state reset"
time="2021-03-27T15:46:42Z" level=info msg="cluster state verified"
time="2021-03-27T15:46:42Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:46:47Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:46:47Z" level=info msg="running kube probe on try 1"
evaluating test case: nil pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          ns: x
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:47:20Z" level=info msg="finished policy #28"
time="2021-03-27T15:47:20Z" level=info msg="starting test case #29"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | .   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:47:23Z" level=info msg="cluster state reset"
time="2021-03-27T15:47:26Z" level=info msg="cluster state verified"
time="2021-03-27T15:47:26Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:47:31Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:47:31Z" level=info msg="running kube probe on try 1"
evaluating test case: empty pods + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: all                     |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector: {}
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | .   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:48:05Z" level=info msg="finished policy #29"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:48:05Z" level=info msg="starting test case #30"
time="2021-03-27T15:48:08Z" level=info msg="cluster state reset"
time="2021-03-27T15:48:11Z" level=info msg="cluster state verified"
time="2021-03-27T15:48:11Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:48:16Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:48:16Z" level=info msg="running kube probe on try 1"
evaluating test case: pods by label + ns by label
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   ns: x                       |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   pod: c                      |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          ns: x
      podSelector:
        matchLabels:
          pod: c
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:48:48Z" level=info msg="finished policy #30"
time="2021-03-27T15:48:48Z" level=info msg="starting test case #31"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | .   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:48:51Z" level=info msg="cluster state reset"
time="2021-03-27T15:48:54Z" level=info msg="cluster state verified"
time="2021-03-27T15:48:54Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:48:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:48:59Z" level=info msg="running kube probe on try 1"
evaluating test case: simple ipblock
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 192.168.193.9/24              | port 80 on protocol TCP |
|         |               |              | except []                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - ipBlock:
        cidr: 192.168.193.9/24
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | .   | X   | .   | X   | .   | X   | .   | .   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:49:31Z" level=info msg="finished policy #31"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:49:31Z" level=info msg="starting test case #32"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:49:34Z" level=info msg="cluster state reset"
time="2021-03-27T15:49:37Z" level=info msg="cluster state verified"
time="2021-03-27T15:49:37Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:49:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:49:42Z" level=info msg="running kube probe on try 1"
evaluating test case: ipblock with except
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | 192.168.193.9/24              | port 80 on protocol TCP |
|         |               |              | except [192.168.193.9/28]     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - ipBlock:
        cidr: 192.168.193.9/24
        except:
        - 192.168.193.9/28
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:50:15Z" level=info msg="finished policy #32"
time="2021-03-27T15:50:15Z" level=info msg="starting test case #33"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:50:18Z" level=info msg="cluster state reset"
time="2021-03-27T15:50:21Z" level=info msg="cluster state verified"
time="2021-03-27T15:50:21Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:50:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:50:26Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: empty port/protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | all ports, all protocols |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:50:57Z" level=info msg="finished policy #33"
time="2021-03-27T15:50:57Z" level=info msg="starting test case #34"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:51:00Z" level=info msg="cluster state reset"
time="2021-03-27T15:51:03Z" level=info msg="cluster state verified"
time="2021-03-27T15:51:03Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:51:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:51:08Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: empty port/protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | all ports, all protocols |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:51:40Z" level=info msg="finished policy #34"
time="2021-03-27T15:51:40Z" level=info msg="starting test case #35"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:51:43Z" level=info msg="cluster state reset"
time="2021-03-27T15:51:46Z" level=info msg="cluster state verified"
time="2021-03-27T15:51:46Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:51:51Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:51:51Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:52:23Z" level=info msg="finished policy #35"
time="2021-03-27T15:52:23Z" level=info msg="starting test case #36"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:52:26Z" level=info msg="cluster state reset"
time="2021-03-27T15:52:29Z" level=info msg="cluster state verified"
time="2021-03-27T15:52:29Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:52:34Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:52:34Z" level=info msg="running kube probe on try 1"
time="2021-03-27T15:53:07Z" level=info msg="finished policy #36"
time="2021-03-27T15:53:07Z" level=info msg="starting test case #37"
evaluating test case: direction,egress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:53:10Z" level=info msg="cluster state reset"
time="2021-03-27T15:53:13Z" level=info msg="cluster state verified"
time="2021-03-27T15:53:13Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:53:18Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:53:18Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:53:51Z" level=info msg="finished policy #37"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T15:53:51Z" level=info msg="starting test case #38"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:53:54Z" level=info msg="cluster state reset"
time="2021-03-27T15:53:57Z" level=info msg="cluster state verified"
time="2021-03-27T15:53:57Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:54:02Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:54:02Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:54:34Z" level=info msg="finished policy #38"
time="2021-03-27T15:54:34Z" level=info msg="starting test case #39"
time="2021-03-27T15:54:37Z" level=info msg="cluster state reset"
time="2021-03-27T15:54:40Z" level=info msg="cluster state verified"
time="2021-03-27T15:54:40Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:54:45Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:54:45Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:55:18Z" level=info msg="finished policy #39"
time="2021-03-27T15:55:18Z" level=info msg="starting test case #40"
time="2021-03-27T15:55:21Z" level=info msg="cluster state reset"
time="2021-03-27T15:55:24Z" level=info msg="cluster state verified"
time="2021-03-27T15:55:24Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:55:29Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:55:29Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:56:02Z" level=info msg="finished policy #40"
time="2021-03-27T15:56:02Z" level=info msg="starting test case #41"
time="2021-03-27T15:56:05Z" level=info msg="cluster state reset"
time="2021-03-27T15:56:08Z" level=info msg="cluster state verified"
time="2021-03-27T15:56:08Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:56:13Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:56:13Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol UDP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:56:47Z" level=info msg="finished policy #41"
time="2021-03-27T15:56:47Z" level=info msg="starting test case #42"
time="2021-03-27T15:56:50Z" level=info msg="cluster state reset"
time="2021-03-27T15:56:53Z" level=info msg="cluster state verified"
time="2021-03-27T15:56:53Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:56:58Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:56:58Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T15:57:31Z" level=info msg="finished policy #42"
time="2021-03-27T15:57:31Z" level=info msg="starting test case #43"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:57:34Z" level=info msg="cluster state reset"
time="2021-03-27T15:57:37Z" level=info msg="cluster state verified"
time="2021-03-27T15:57:37Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:57:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:57:42Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol UDP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:58:15Z" level=info msg="finished policy #43"
time="2021-03-27T15:58:15Z" level=info msg="starting test case #44"
time="2021-03-27T15:58:18Z" level=info msg="cluster state reset"
time="2021-03-27T15:58:21Z" level=info msg="cluster state verified"
time="2021-03-27T15:58:21Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:58:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:58:26Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+----------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL        |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols     |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP    |
|         |               |              |   ns In [x y]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [b c]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
|         |               |              |                               |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP    |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+                            +
|         |               |              | namespace: all                |                            |
|         |               |              | pods: all                     |                            |
|         |               |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol SCTP |
|         |               |              |   ns In [y z]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [a b]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:58:59Z" level=info msg="finished policy #44"
time="2021-03-27T15:58:59Z" level=info msg="starting test case #45"
time="2021-03-27T15:59:02Z" level=info msg="cluster state reset"
time="2021-03-27T15:59:05Z" level=info msg="cluster state verified"
time="2021-03-27T15:59:05Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:59:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:59:10Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol SCTP |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T15:59:42Z" level=info msg="finished policy #45"
time="2021-03-27T15:59:42Z" level=info msg="starting test case #46"
time="2021-03-27T15:59:45Z" level=info msg="cluster state reset"
time="2021-03-27T15:59:48Z" level=info msg="cluster state verified"
time="2021-03-27T15:59:48Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T15:59:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T15:59:53Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:00:26Z" level=info msg="finished policy #46"
time="2021-03-27T16:00:26Z" level=info msg="starting test case #47"
evaluating test case: direction,egress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol SCTP |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 81
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:00:29Z" level=info msg="cluster state reset"
time="2021-03-27T16:00:32Z" level=info msg="cluster state verified"
time="2021-03-27T16:00:32Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:00:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:00:37Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-tcp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-80-tcp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:01:10Z" level=info msg="finished policy #47"
time="2021-03-27T16:01:10Z" level=info msg="starting test case #48"
time="2021-03-27T16:01:13Z" level=info msg="cluster state reset"
time="2021-03-27T16:01:16Z" level=info msg="cluster state verified"
time="2021-03-27T16:01:16Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:01:21Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:01:21Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-tcp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-tcp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:01:54Z" level=info msg="finished policy #48"
time="2021-03-27T16:01:54Z" level=info msg="starting test case #49"
time="2021-03-27T16:01:57Z" level=info msg="cluster state reset"
time="2021-03-27T16:02:00Z" level=info msg="cluster state verified"
time="2021-03-27T16:02:00Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:02:05Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:02:05Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-udp on protocol UDP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-80-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:02:38Z" level=info msg="finished policy #49"
time="2021-03-27T16:02:38Z" level=info msg="starting test case #50"
time="2021-03-27T16:02:41Z" level=info msg="cluster state reset"
time="2021-03-27T16:02:44Z" level=info msg="cluster state verified"
time="2021-03-27T16:02:44Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:02:49Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:02:49Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol UDP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:03:22Z" level=info msg="finished policy #50"
time="2021-03-27T16:03:22Z" level=info msg="starting test case #51"
time="2021-03-27T16:03:25Z" level=info msg="cluster state reset"
time="2021-03-27T16:03:28Z" level=info msg="cluster state verified"
time="2021-03-27T16:03:28Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:03:33Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:03:33Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:04:06Z" level=info msg="running kube probe on try 2"
evaluating test case: direction,egress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-sctp on protocol SCTP |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-80-sctp
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

Discrepancy found:4 wrong, 0 ignored, 77 correct
Expected ingress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected egress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected combined:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 0:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 1:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T16:04:41Z" level=info msg="finished policy #51"
time="2021-03-27T16:04:41Z" level=info msg="starting test case #52"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+


Actual vs expected (last round):
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
|     | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a | .   | .   | .   | X   | X   | .   | X   | X   | .   |
| x/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| x/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:04:43Z" level=info msg="cluster state reset"
time="2021-03-27T16:04:46Z" level=info msg="cluster state verified"
time="2021-03-27T16:04:46Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:04:51Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:04:51Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:05:25Z" level=info msg="running kube probe on try 2"
evaluating test case: direction,egress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-sctp on protocol SCTP |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-sctp
      protocol: SCTP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

Discrepancy found:4 wrong, 0 ignored, 77 correct
Expected ingress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected egress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected combined:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 0:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 1:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+


Actual vs expected (last round):
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
|     | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a | .   | .   | .   | X   | X   | .   | X   | X   | .   |
| x/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| x/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:05:59Z" level=info msg="finished policy #52"
time="2021-03-27T16:05:59Z" level=info msg="starting test case #53"
time="2021-03-27T16:06:02Z" level=info msg="cluster state reset"
time="2021-03-27T16:06:05Z" level=info msg="cluster state verified"
time="2021-03-27T16:06:05Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:06:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:06:10Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that doesn't match its protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-81-udp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:06:44Z" level=info msg="finished policy #53"
time="2021-03-27T16:06:44Z" level=info msg="starting test case #54"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:06:46Z" level=info msg="cluster state reset"
time="2021-03-27T16:06:49Z" level=info msg="cluster state verified"
time="2021-03-27T16:06:49Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:06:54Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:06:54Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that isn't served
step 1 on all available ports/protocols:
time="2021-03-27T16:07:28Z" level=info msg="finished policy #54"
time="2021-03-27T16:07:28Z" level=info msg="starting test case #55"
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-7981-udp on protocol TCP |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: serve-7981-udp
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:07:30Z" level=info msg="cluster state reset"
time="2021-03-27T16:07:33Z" level=info msg="cluster state verified"
time="2021-03-27T16:07:33Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:07:38Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:07:39Z" level=info msg="running kube probe on try 1"
evaluating test case: open a numbered port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 7981 on protocol TCP |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
time="2021-03-27T16:08:13Z" level=info msg="finished policy #55"
time="2021-03-27T16:08:13Z" level=info msg="starting test case #56"
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 7981
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:08:16Z" level=info msg="cluster state reset"
time="2021-03-27T16:08:19Z" level=info msg="cluster state verified"
time="2021-03-27T16:08:19Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:08:24Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:08:24Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:08:57Z" level=info msg="finished policy #56"
time="2021-03-27T16:08:57Z" level=info msg="starting test case #57"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:09:00Z" level=info msg="cluster state reset"
time="2021-03-27T16:09:03Z" level=info msg="cluster state verified"
time="2021-03-27T16:09:03Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:09:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:09:08Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:09:42Z" level=info msg="finished policy #57"
time="2021-03-27T16:09:42Z" level=info msg="starting test case #58"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:09:45Z" level=info msg="cluster state reset"
time="2021-03-27T16:09:48Z" level=info msg="cluster state verified"
time="2021-03-27T16:09:48Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:09:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:09:53Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:10:26Z" level=info msg="finished policy #58"
time="2021-03-27T16:10:26Z" level=info msg="starting test case #59"
time="2021-03-27T16:10:29Z" level=info msg="cluster state reset"
time="2021-03-27T16:10:32Z" level=info msg="cluster state verified"
time="2021-03-27T16:10:32Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:10:37Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:10:37Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:11:10Z" level=info msg="finished policy #59"
time="2021-03-27T16:11:10Z" level=info msg="starting test case #60"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:11:13Z" level=info msg="cluster state reset"
time="2021-03-27T16:11:16Z" level=info msg="cluster state verified"
time="2021-03-27T16:11:16Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:11:21Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:11:21Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:11:55Z" level=info msg="finished policy #60"
time="2021-03-27T16:11:55Z" level=info msg="starting test case #61"
time="2021-03-27T16:11:57Z" level=info msg="cluster state reset"
time="2021-03-27T16:12:00Z" level=info msg="cluster state verified"
time="2021-03-27T16:12:00Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:12:05Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:12:05Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:12:43Z" level=info msg="finished policy #61"
time="2021-03-27T16:12:43Z" level=info msg="starting test case #62"
time="2021-03-27T16:12:46Z" level=info msg="cluster state reset"
time="2021-03-27T16:12:49Z" level=info msg="cluster state verified"
time="2021-03-27T16:12:49Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:12:54Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:12:54Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol UDP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:13:31Z" level=info msg="finished policy #62"
time="2021-03-27T16:13:31Z" level=info msg="starting test case #63"
time="2021-03-27T16:13:34Z" level=info msg="cluster state reset"
time="2021-03-27T16:13:37Z" level=info msg="cluster state verified"
time="2021-03-27T16:13:37Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:13:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:13:42Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:14:20Z" level=info msg="finished policy #63"
time="2021-03-27T16:14:20Z" level=info msg="starting test case #64"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:14:23Z" level=info msg="cluster state reset"
time="2021-03-27T16:14:26Z" level=info msg="cluster state verified"
time="2021-03-27T16:14:26Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:14:31Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:14:31Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol UDP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:15:04Z" level=info msg="finished policy #64"
time="2021-03-27T16:15:04Z" level=info msg="starting test case #65"
time="2021-03-27T16:15:07Z" level=info msg="cluster state reset"
time="2021-03-27T16:15:10Z" level=info msg="cluster state verified"
time="2021-03-27T16:15:10Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:15:15Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:15:15Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+----------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL        |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols     |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol SCTP |
|         |               |              |   ns In [x y]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [b c]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
|         |               |              |                               |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP    |
|         | Match labels: |              |                               |                            |
|         |   pod: a      |              |                               |                            |
+         +               +              +-------------------------------+                            +
|         |               |              | namespace: all                |                            |
|         |               |              | pods: all                     |                            |
|         |               |              |                               |                            |
+         +               +              +-------------------------------+----------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP    |
|         |               |              |   ns In [y z]                 |                            |
|         |               |              | pods: Match expressions:      |                            |
|         |               |              |   pod In [a b]                |                            |
+---------+---------------+--------------+-------------------------------+----------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:15:54Z" level=info msg="finished policy #65"
time="2021-03-27T16:15:54Z" level=info msg="starting test case #66"
time="2021-03-27T16:15:56Z" level=info msg="cluster state reset"
time="2021-03-27T16:15:59Z" level=info msg="cluster state verified"
time="2021-03-27T16:15:59Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:16:04Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:16:05Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol SCTP |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+                          +
|         |               |              | namespace: all                |                          |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:16:39Z" level=info msg="finished policy #66"
time="2021-03-27T16:16:39Z" level=info msg="starting test case #67"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:16:42Z" level=info msg="cluster state reset"
time="2021-03-27T16:16:45Z" level=info msg="cluster state verified"
time="2021-03-27T16:16:45Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:16:50Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:16:50Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,numbered-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+--------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols   |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 81 on protocol SCTP |
|         |               |              |   ns In [x y]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [b c]                |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP  |
|         | Match labels: |              |                               |                          |
|         |   pod: a      |              |                               |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP  |
|         |               |              |   ns In [y z]                 |                          |
|         |               |              | pods: Match expressions:      |                          |
|         |               |              |   pod In [a b]                |                          |
+         +               +              +-------------------------------+--------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP  |
|         |               |              | pods: all                     |                          |
|         |               |              |                               |                          |
+---------+---------------+--------------+-------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 81
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:17:24Z" level=info msg="finished policy #67"
time="2021-03-27T16:17:24Z" level=info msg="starting test case #68"
time="2021-03-27T16:17:27Z" level=info msg="cluster state reset"
time="2021-03-27T16:17:30Z" level=info msg="cluster state verified"
time="2021-03-27T16:17:30Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:17:35Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:17:35Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-tcp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-80-tcp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:18:09Z" level=info msg="finished policy #68"
time="2021-03-27T16:18:09Z" level=info msg="starting test case #69"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:18:12Z" level=info msg="cluster state reset"
time="2021-03-27T16:18:15Z" level=info msg="cluster state verified"
time="2021-03-27T16:18:15Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:18:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:18:20Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,tcp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-tcp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-tcp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:18:54Z" level=info msg="finished policy #69"
time="2021-03-27T16:18:54Z" level=info msg="starting test case #70"
time="2021-03-27T16:18:57Z" level=info msg="cluster state reset"
time="2021-03-27T16:19:00Z" level=info msg="cluster state verified"
time="2021-03-27T16:19:00Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:19:05Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:19:05Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-udp on protocol UDP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-80-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:19:42Z" level=info msg="finished policy #70"
time="2021-03-27T16:19:42Z" level=info msg="starting test case #71"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:19:45Z" level=info msg="cluster state reset"
time="2021-03-27T16:19:48Z" level=info msg="cluster state verified"
time="2021-03-27T16:19:48Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:19:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:19:53Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,named-port,port,protocol,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol UDP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:20:29Z" level=info msg="finished policy #71"
time="2021-03-27T16:20:29Z" level=info msg="starting test case #72"
time="2021-03-27T16:20:31Z" level=info msg="cluster state reset"
time="2021-03-27T16:20:34Z" level=info msg="cluster state verified"
time="2021-03-27T16:20:34Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:20:39Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:20:39Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:21:13Z" level=info msg="running kube probe on try 2"
evaluating test case: direction,ingress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-80-sctp on protocol SCTP |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-80-sctp
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

Discrepancy found:4 wrong, 0 ignored, 77 correct
Expected ingress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected egress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected combined:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 0:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 1:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T16:21:50Z" level=info msg="finished policy #72"
time="2021-03-27T16:21:50Z" level=info msg="starting test case #73"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+


Actual vs expected (last round):
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
|     | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| x/b | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| x/c | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/b | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/c | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:21:53Z" level=info msg="cluster state reset"
time="2021-03-27T16:21:56Z" level=info msg="cluster state verified"
time="2021-03-27T16:21:56Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:22:01Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:22:01Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:22:35Z" level=info msg="running kube probe on try 2"
evaluating test case: direction,ingress,named-port,port,protocol,sctp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-sctp on protocol SCTP |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-sctp
      protocol: SCTP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

Discrepancy found:4 wrong, 0 ignored, 77 correct
Expected ingress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected egress:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

Expected combined:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 0:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

kube results, try 1:
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+


Actual vs expected (last round):
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
|     | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| x/b | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| x/c | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/b | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| y/c | X   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/a | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/b | .   | .   | .   | .   | .   | .   | .   | .   | .   |
| z/c | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:23:08Z" level=info msg="finished policy #73"
time="2021-03-27T16:23:08Z" level=info msg="starting test case #74"
time="2021-03-27T16:23:11Z" level=info msg="cluster state reset"
time="2021-03-27T16:23:14Z" level=info msg="cluster state verified"
time="2021-03-27T16:23:14Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:23:19Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:23:19Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that doesn't match its protocol
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-udp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:23:53Z" level=info msg="finished policy #74"
time="2021-03-27T16:23:53Z" level=info msg="starting test case #75"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:23:56Z" level=info msg="cluster state reset"
time="2021-03-27T16:23:59Z" level=info msg="cluster state verified"
time="2021-03-27T16:23:59Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:24:04Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:24:04Z" level=info msg="running kube probe on try 1"
evaluating test case: open a named port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |            PORT/PROTOCOL            |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols              |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port serve-7981-udp on protocol TCP |
|         |               |              |   ns In [x y]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [b c]                |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP             |
|         | Match labels: |              |                               |                                     |
|         |   pod: a      |              |                               |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP             |
|         |               |              |   ns In [y z]                 |                                     |
|         |               |              | pods: Match expressions:      |                                     |
|         |               |              |   pod In [a b]                |                                     |
+         +               +              +-------------------------------+-------------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP             |
|         |               |              | pods: all                     |                                     |
|         |               |              |                               |                                     |
+---------+---------------+--------------+-------------------------------+-------------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-7981-udp
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:24:36Z" level=info msg="finished policy #75"
time="2021-03-27T16:24:36Z" level=info msg="starting test case #76"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:24:39Z" level=info msg="cluster state reset"
time="2021-03-27T16:24:42Z" level=info msg="cluster state verified"
time="2021-03-27T16:24:42Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:24:47Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:24:47Z" level=info msg="running kube probe on try 1"
evaluating test case: open a numbered port that isn't served
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 7981 on protocol TCP |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 7981
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:25:20Z" level=info msg="finished policy #76"
time="2021-03-27T16:25:20Z" level=info msg="starting test case #77"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:25:23Z" level=info msg="cluster state reset"
time="2021-03-27T16:25:26Z" level=info msg="cluster state verified"
time="2021-03-27T16:25:26Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:25:31Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:25:31Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 | port 80 on protocol TCP   |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    - port: 80
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:26:04Z" level=info msg="finished policy #77"
time="2021-03-27T16:26:04Z" level=info msg="starting test case #78"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:26:06Z" level=info msg="cluster state reset"
time="2021-03-27T16:26:09Z" level=info msg="cluster state verified"
time="2021-03-27T16:26:09Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:26:14Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:26:14Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,multi-port/protocol,named-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP         |
|         |               |              |   ns In [y z]                 | port serve-80-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    - port: serve-80-tcp
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:26:47Z" level=info msg="finished policy #78"
time="2021-03-27T16:26:47Z" level=info msg="starting test case #79"
time="2021-03-27T16:26:50Z" level=info msg="cluster state reset"
time="2021-03-27T16:26:53Z" level=info msg="cluster state verified"
time="2021-03-27T16:26:53Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:26:58Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:26:58Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,egress,multi-port/protocol,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [x y]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [y z]                 | all ports on protocol UDP |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - {}
    - protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:27:31Z" level=info msg="finished policy #79"
time="2021-03-27T16:27:31Z" level=info msg="starting test case #80"
time="2021-03-27T16:27:34Z" level=info msg="cluster state reset"
time="2021-03-27T16:27:37Z" level=info msg="cluster state verified"
time="2021-03-27T16:27:37Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:27:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:27:42Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 | port 81 on protocol TCP |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    - port: 81
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:28:15Z" level=info msg="finished policy #80"
time="2021-03-27T16:28:15Z" level=info msg="starting test case #81"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:28:18Z" level=info msg="cluster state reset"
time="2021-03-27T16:28:21Z" level=info msg="cluster state verified"
time="2021-03-27T16:28:21Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:28:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:28:26Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,named-port,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 | port serve-81-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    - port: serve-81-tcp
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:29:00Z" level=info msg="finished policy #81"
time="2021-03-27T16:29:00Z" level=info msg="starting test case #82"
time="2021-03-27T16:29:03Z" level=info msg="cluster state reset"
time="2021-03-27T16:29:06Z" level=info msg="cluster state verified"
time="2021-03-27T16:29:06Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:29:11Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:29:11Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
    - port: serve-81-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
time="2021-03-27T16:29:44Z" level=info msg="finished policy #82"
time="2021-03-27T16:29:44Z" level=info msg="starting test case #83"
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:29:47Z" level=info msg="cluster state reset"
time="2021-03-27T16:29:50Z" level=info msg="cluster state verified"
time="2021-03-27T16:29:50Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:29:55Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:29:55Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP           |
|         |               |              |   ns In [y z]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: UDP
    - port: serve-81-udp
      protocol: UDP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
time="2021-03-27T16:30:30Z" level=info msg="finished policy #83"
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:30:30Z" level=info msg="starting test case #84"
time="2021-03-27T16:30:32Z" level=info msg="cluster state reset"
time="2021-03-27T16:30:35Z" level=info msg="cluster state verified"
time="2021-03-27T16:30:35Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:30:40Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:30:41Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 | port 80 on protocol TCP   |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
    - port: 80
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:31:13Z" level=info msg="finished policy #84"
time="2021-03-27T16:31:13Z" level=info msg="starting test case #85"
time="2021-03-27T16:31:16Z" level=info msg="cluster state reset"
time="2021-03-27T16:31:19Z" level=info msg="cluster state verified"
time="2021-03-27T16:31:19Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:31:24Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:31:24Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,multi-port/protocol,named-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP         |
|         |               |              |   ns In [x y]                 | port serve-80-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
    - port: serve-80-tcp
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:31:57Z" level=info msg="finished policy #85"
time="2021-03-27T16:31:57Z" level=info msg="starting test case #86"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:32:00Z" level=info msg="cluster state reset"
time="2021-03-27T16:32:03Z" level=info msg="cluster state verified"
time="2021-03-27T16:32:03Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:32:08Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:32:08Z" level=info msg="running kube probe on try 1"
evaluating test case: any-port,direction,ingress,multi-port/protocol,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+---------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |       PORT/PROTOCOL       |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols    |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | all ports on protocol TCP |
|         |               |              |   ns In [x y]                 | all ports on protocol UDP |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [b c]                |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP   |
|         | Match labels: |              |                               |                           |
|         |   pod: a      |              |                               |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP   |
|         |               |              |   ns In [y z]                 |                           |
|         |               |              | pods: Match expressions:      |                           |
|         |               |              |   pod In [a b]                |                           |
+         +               +              +-------------------------------+---------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP   |
|         |               |              | pods: all                     |                           |
|         |               |              |                               |                           |
+---------+---------------+--------------+-------------------------------+---------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - {}
    - protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:32:41Z" level=info msg="finished policy #86"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:32:41Z" level=info msg="starting test case #87"
time="2021-03-27T16:32:44Z" level=info msg="cluster state reset"
time="2021-03-27T16:32:47Z" level=info msg="cluster state verified"
time="2021-03-27T16:32:47Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:32:52Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:32:52Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 | port 81 on protocol TCP |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
    - port: 81
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:33:24Z" level=info msg="finished policy #87"
time="2021-03-27T16:33:24Z" level=info msg="starting test case #88"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:33:27Z" level=info msg="cluster state reset"
time="2021-03-27T16:33:30Z" level=info msg="cluster state verified"
time="2021-03-27T16:33:30Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:33:35Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:33:35Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,named-port,numbered-port,port,rule
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 | port serve-81-tcp on protocol TCP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
    - port: serve-81-tcp
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:34:08Z" level=info msg="finished policy #88"
time="2021-03-27T16:34:08Z" level=info msg="starting test case #89"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:34:11Z" level=info msg="cluster state reset"
time="2021-03-27T16:34:14Z" level=info msg="cluster state verified"
time="2021-03-27T16:34:14Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:34:19Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:34:19Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [x y]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:34:52Z" level=info msg="finished policy #89"
time="2021-03-27T16:34:52Z" level=info msg="starting test case #90"
time="2021-03-27T16:34:55Z" level=info msg="cluster state reset"
time="2021-03-27T16:34:58Z" level=info msg="cluster state verified"
time="2021-03-27T16:34:58Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:35:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:35:03Z" level=info msg="running kube probe on try 1"
evaluating test case: direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol UDP           |
|         |               |              |   ns In [x y]                 | port serve-81-udp on protocol UDP |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+                                   +
|         |               |              | namespace: all                |                                   |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: UDP
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:35:35Z" level=info msg="finished policy #90"
time="2021-03-27T16:35:35Z" level=info msg="starting test case #91"
time="2021-03-27T16:35:38Z" level=info msg="cluster state reset"
time="2021-03-27T16:35:41Z" level=info msg="cluster state verified"
time="2021-03-27T16:35:41Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:35:46Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:35:46Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:36:19Z" level=info msg="step 2: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:36:24Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:36:24Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/delete policy
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+------+--------+--------------+------+---------------+
| TYPE | TARGET | SOURCE RULES | PEER | PORT/PROTOCOL |
+------+--------+--------------+------+---------------+
|      |        |              |      |               |
+------+--------+--------------+------+---------------+



Results for network policies:
no network policies
0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:36:56Z" level=info msg="finished policy #91"
time="2021-03-27T16:36:56Z" level=info msg="starting test case #92"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:36:59Z" level=info msg="cluster state reset"
time="2021-03-27T16:37:02Z" level=info msg="cluster state verified"
time="2021-03-27T16:37:02Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:37:07Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:37:07Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:37:40Z" level=info msg="step 2: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:37:45Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:37:45Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/update policy
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |           PORT/PROTOCOL           |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols            |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port serve-81-udp on protocol UDP |
|         |               |              |   ns In [x y]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [b c]                |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP           |
|         | Match labels: |              |                               |                                   |
|         |   pod: a      |              |                               |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP           |
|         |               |              |   ns In [y z]                 |                                   |
|         |               |              | pods: Match expressions:      |                                   |
|         |               |              |   pod In [a b]                |                                   |
+         +               +              +-------------------------------+-----------------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP           |
|         |               |              | pods: all                     |                                   |
|         |               |              |                               |                                   |
+---------+---------------+--------------+-------------------------------+-----------------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: serve-81-udp
      protocol: UDP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
time="2021-03-27T16:38:23Z" level=info msg="finished policy #92"
time="2021-03-27T16:38:23Z" level=info msg="starting test case #93"
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:38:26Z" level=info msg="cluster state reset"
time="2021-03-27T16:38:29Z" level=info msg="cluster state verified"
time="2021-03-27T16:38:29Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:38:34Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:38:34Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:39:19Z" level=info msg="step 2: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:39:24Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:39:24Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:40:15Z" level=info msg="step 3: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:40:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:40:20Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/delete namespace
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 121 correct
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y-2/A | Y-2/B | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |       |       |     |     |     |     |     |     |
| TCP/80  |     |     |     |       |       |     |     |     |     |     |     |
| TCP/81  |     |     |     |       |       |     |     |     |     |     |     |
| UDP/80  |     |     |     |       |       |     |     |     |     |     |     |
| UDP/81  |     |     |     |       |       |     |     |     |     |     |     |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .     | .     | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X     | X     | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y-2/a   | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y-2/b   | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .     | .     | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-------+-------+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+                         +
|         |               |              | namespace: all                |                         |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:40:56Z" level=info msg="finished policy #93"
time="2021-03-27T16:40:56Z" level=info msg="starting test case #94"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:40:59Z" level=info msg="cluster state reset"
time="2021-03-27T16:41:02Z" level=info msg="cluster state verified"
time="2021-03-27T16:41:02Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:41:07Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:41:07Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:41:41Z" level=info msg="step 2: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:41:46Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:41:46Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:42:20Z" level=info msg="step 3: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:42:25Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:42:25Z" level=info msg="running kube probe on try 1"
evaluating test case: Update namespace so that policy applies, then again so it no longer applies
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   new-ns: qrs                 |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          new-ns: qrs
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   new-ns: qrs                 |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          new-ns: qrs
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:42:59Z" level=info msg="finished policy #94"
time="2021-03-27T16:42:59Z" level=info msg="starting test case #95"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match labels:      | port 80 on protocol TCP |
|         |               |              |   new-ns: qrs                 |                         |
|         |               |              | pods: all                     |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          new-ns: qrs
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:43:02Z" level=info msg="cluster state reset"
time="2021-03-27T16:43:05Z" level=info msg="cluster state verified"
time="2021-03-27T16:43:05Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:43:10Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:43:10Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:43:49Z" level=info msg="step 2: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:43:54Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:43:54Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:44:36Z" level=info msg="step 3: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:44:41Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:44:41Z" level=info msg="running kube probe on try 1"
evaluating test case: Create/delete pod
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 100 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | X/D | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/d     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [x y]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [b c]                |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - x
          - "y"
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - b
          - c
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

time="2021-03-27T16:45:16Z" level=info msg="finished policy #95"
time="2021-03-27T16:45:16Z" level=info msg="starting test case #96"


time="2021-03-27T16:45:19Z" level=info msg="cluster state reset"
time="2021-03-27T16:45:22Z" level=info msg="cluster state verified"
time="2021-03-27T16:45:22Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:45:27Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:45:27Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:46:01Z" level=info msg="step 2: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:46:06Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:46:06Z" level=info msg="running kube probe on try 1"
time="2021-03-27T16:46:40Z" level=info msg="step 3: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:46:45Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:46:45Z" level=info msg="running kube probe on try 1"
evaluating test case: Update pod so that policy applies, then again so it no longer applies
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   new-label: abc              |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchLabels:
          new-label: abc
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 2 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   new-label: abc              |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchLabels:
          new-label: abc
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+

step 3 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------+-------------------------------+-------------------------+
|  TYPE   |    TARGET     | SOURCE RULES |             PEER              |      PORT/PROTOCOL      |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Ingress | namespace: x  | x/base       | no ips                        | no ports, no protocols  |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match labels:           |                         |
|         |               |              |   new-label: abc              |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+
| Egress  | namespace: x  | x/base       | ports for all IPs             | port 53 on protocol UDP |
|         | Match labels: |              |                               |                         |
|         |   pod: a      |              |                               |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: Match expressions: | port 80 on protocol TCP |
|         |               |              |   ns In [y z]                 |                         |
|         |               |              | pods: Match expressions:      |                         |
|         |               |              |   pod In [a b]                |                         |
+         +               +              +-------------------------------+-------------------------+
|         |               |              | namespace: all                | port 53 on protocol UDP |
|         |               |              | pods: all                     |                         |
|         |               |              |                               |                         |
+---------+---------------+--------------+-------------------------------+-------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: base
  namespace: x
spec:
  egress:
  - ports:
    - port: 80
      protocol: TCP
    to:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchExpressions:
        - key: pod
          operator: In
          values:
          - a
          - b
  - ports:
    - port: 53
      protocol: UDP
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: ns
          operator: In
          values:
          - "y"
          - z
      podSelector:
        matchLabels:
          new-label: abc
    ports:
    - port: 80
      protocol: TCP
  podSelector:
    matchLabels:
      pod: a
  policyTypes:
  - Ingress
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:47:19Z" level=info msg="finished policy #96"
time="2021-03-27T16:47:19Z" level=info msg="starting test case #97"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | .   | .   | X   | .   | .   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | X   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:47:22Z" level=info msg="cluster state reset"
time="2021-03-27T16:47:25Z" level=info msg="cluster state verified"
time="2021-03-27T16:47:25Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:47:30Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:47:30Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all from source, allow all to dest
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |    SOURCE RULES     |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+---------------------+-------------------+--------------------------+
| Ingress | namespace: y  | y/allow-all-ingress | all pods, all ips | all ports, all protocols |
|         | Match labels: |                     |                   |                          |
|         |   pod: c      |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+
|         |               |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+
| Egress  | namespace: x  | x/deny-all-egress   | ports for all IPs | port 53 on protocol UDP  |
|         | Match labels: | x/allow-dns         |                   |                          |
|         |   pod: b      |                     |                   |                          |
+         +               +                     +-------------------+                          +
|         |               |                     | namespace: all    |                          |
|         |               |                     | pods: all         |                          |
|         |               |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress
  namespace: "y"
spec:
  ingress:
  - {}
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:48:03Z" level=info msg="finished policy #97"
time="2021-03-27T16:48:03Z" level=info msg="starting test case #98"
time="2021-03-27T16:48:06Z" level=info msg="cluster state reset"
time="2021-03-27T16:48:09Z" level=info msg="cluster state verified"
time="2021-03-27T16:48:09Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:48:14Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:48:14Z" level=info msg="running kube probe on try 1"
evaluating test case: allow all from source, deny all to dest
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |    SOURCE RULES    |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+--------------------+-------------------+--------------------------+
| Ingress | namespace: y  | y/deny-all-ingress | no pods, no ips   | no ports, no protocols   |
|         | Match labels: |                    |                   |                          |
|         |   pod: c      |                    |                   |                          |
+---------+---------------+--------------------+-------------------+--------------------------+
|         |               |                    |                   |                          |
+---------+---------------+--------------------+-------------------+--------------------------+
| Egress  | namespace: x  | x/allow-all-egress | all pods, all ips | all ports, all protocols |
|         | Match labels: | x/allow-dns        |                   |                          |
|         |   pod: b      |                    |                   |                          |
+---------+---------------+--------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress
  namespace: x
spec:
  egress:
  - {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: "y"
spec:
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | X   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:48:47Z" level=info msg="finished policy #98"
time="2021-03-27T16:48:47Z" level=info msg="starting test case #99"
time="2021-03-27T16:48:50Z" level=info msg="cluster state reset"
time="2021-03-27T16:48:53Z" level=info msg="cluster state verified"
time="2021-03-27T16:48:53Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:48:58Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:48:58Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+--------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |    SOURCE RULES    |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+--------------------+-------------------+--------------------------+
|        |               |                    |                   |                          |
+--------+---------------+--------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress  | all pods, all ips | all ports, all protocols |
|        | Match labels: | x/allow-all-egress |                   |                          |
|        |   pod: b      | x/allow-dns        |                   |                          |
+--------+---------------+--------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress
  namespace: x
spec:
  egress:
  - {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:49:31Z" level=info msg="finished policy #99"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:49:31Z" level=info msg="starting test case #100"
time="2021-03-27T16:49:34Z" level=info msg="cluster state reset"
time="2021-03-27T16:49:37Z" level=info msg="cluster state verified"
time="2021-03-27T16:49:37Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:49:42Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:49:42Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all to same dest
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |    SOURCE RULES     |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+---------------------+-------------------+--------------------------+
| Ingress | namespace: y  | y/deny-all-ingress  | all pods, all ips | all ports, all protocols |
|         | Match labels: | y/allow-all-ingress |                   |                          |
|         |   pod: c      |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+
|         |               |                     |                   |                          |
+---------+---------------+---------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: "y"
spec:
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress
  namespace: "y"
spec:
  ingress:
  - {}
  podSelector:
    matchLabels:
      pod: c
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:50:15Z" level=info msg="finished policy #100"
time="2021-03-27T16:50:15Z" level=info msg="starting test case #101"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:50:18Z" level=info msg="cluster state reset"
time="2021-03-27T16:50:21Z" level=info msg="cluster state verified"
time="2021-03-27T16:50:21Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:50:26Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:50:26Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by pod from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+---------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+---------------------------+-------------------+--------------------------+
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress         | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-pod |                   |                          |
|        |   pod: b      | x/allow-dns               |                   |                          |
+        +               +                           +-------------------+--------------------------+
|        |               |                           | all pods          | all ports, all protocols |
|        |               |                           |                   |                          |
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-pod
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:50:58Z" level=info msg="finished policy #101"
time="2021-03-27T16:50:58Z" level=info msg="starting test case #102"
time="2021-03-27T16:51:01Z" level=info msg="cluster state reset"
time="2021-03-27T16:51:04Z" level=info msg="cluster state verified"
time="2021-03-27T16:51:04Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:51:09Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:51:09Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by IP from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+--------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES       |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+--------------------------+-------------------+--------------------------+
|        |               |                          |                   |                          |
+--------+---------------+--------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress        | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-ip |                   |                          |
|        |   pod: b      | x/allow-dns              |                   |                          |
+        +               +                          +-------------------+--------------------------+
|        |               |                          | 0.0.0.0/0         | all ports, all protocols |
|        |               |                          | except []         |                          |
|        |               |                          |                   |                          |
+        +               +                          +-------------------+--------------------------+
|        |               |                          | namespace: all    | port 53 on protocol UDP  |
|        |               |                          | pods: all         |                          |
|        |               |                          |                   |                          |
+--------+---------------+--------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:51:42Z" level=info msg="finished policy #102"
time="2021-03-27T16:51:42Z" level=info msg="starting test case #103"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:51:45Z" level=info msg="cluster state reset"
time="2021-03-27T16:51:48Z" level=info msg="cluster state verified"
time="2021-03-27T16:51:48Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:51:53Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:51:53Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by IP + allow all by pod from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+---------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+---------------------------+-------------------+--------------------------+
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-ip   | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-pod |                   |                          |
|        |   pod: b      | x/allow-dns               |                   |                          |
+        +               +                           +-------------------+--------------------------+
|        |               |                           | 0.0.0.0/31        | all ports, all protocols |
|        |               |                           | except []         |                          |
|        |               |                           |                   |                          |
+        +               +                           +-------------------+                          +
|        |               |                           | all pods          |                          |
|        |               |                           |                   |                          |
|        |               |                           |                   |                          |
+--------+---------------+---------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-pod
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:52:25Z" level=info msg="finished policy #103"
time="2021-03-27T16:52:25Z" level=info msg="starting test case #104"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:52:28Z" level=info msg="cluster state reset"
time="2021-03-27T16:52:31Z" level=info msg="cluster state verified"
time="2021-03-27T16:52:31Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:52:36Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:52:36Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by pod + allow all by IP from same source
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+--------------------------+----------------------------------+--------------------------+
|  TYPE  |    TARGET     |       SOURCE RULES       |               PEER               |      PORT/PROTOCOL       |
+--------+---------------+--------------------------+----------------------------------+--------------------------+
|        |               |                          |                                  |                          |
+--------+---------------+--------------------------+----------------------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-pod | ports for all IPs                | port 53 on protocol UDP  |
|        | Match labels: | x/allow-all-egress-by-ip |                                  |                          |
|        |   pod: b      | x/allow-dns              |                                  |                          |
+        +               +                          +----------------------------------+--------------------------+
|        |               |                          | 0.0.0.0/0                        | all ports, all protocols |
|        |               |                          | except []                        |                          |
|        |               |                          |                                  |                          |
+        +               +                          +----------------------------------+--------------------------+
|        |               |                          | namespace: all                   | port 53 on protocol UDP  |
|        |               |                          | pods: all                        |                          |
|        |               |                          |                                  |                          |
+        +               +                          +----------------------------------+--------------------------+
|        |               |                          | namespace: Match labels:         | all ports, all protocols |
|        |               |                          |   this-will-never-happen: qrs123 |                          |
|        |               |                          | pods: all                        |                          |
+--------+---------------+--------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-pod
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:53:09Z" level=info msg="finished policy #104"
time="2021-03-27T16:53:09Z" level=info msg="starting test case #105"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:53:12Z" level=info msg="cluster state reset"
time="2021-03-27T16:53:15Z" level=info msg="cluster state verified"
time="2021-03-27T16:53:15Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:53:20Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:53:20Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by pod to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+----------------------------+----------+--------------------------+
|  TYPE   |    TARGET     |        SOURCE RULES        |   PEER   |      PORT/PROTOCOL       |
+---------+---------------+----------------------------+----------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress         | no ips   | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-pod |          |                          |
|         |   pod: b      |                            |          |                          |
+         +               +                            +----------+--------------------------+
|         |               |                            | all pods | all ports, all protocols |
|         |               |                            |          |                          |
|         |               |                            |          |                          |
+---------+---------------+----------------------------+----------+--------------------------+
|         |               |                            |          |                          |
+---------+---------------+----------------------------+----------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-pod
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:53:53Z" level=info msg="finished policy #105"
time="2021-03-27T16:53:53Z" level=info msg="starting test case #106"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:53:55Z" level=info msg="cluster state reset"
time="2021-03-27T16:53:58Z" level=info msg="cluster state verified"
time="2021-03-27T16:53:58Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:54:03Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:54:03Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all + allow all by IP to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+---------------------------+-------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress        | ports for all IPs | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-ip |                   |                          |
|         |   pod: b      |                           |                   |                          |
+         +               +                           +-------------------+--------------------------+
|         |               |                           | 0.0.0.0/0         | all ports, all protocols |
|         |               |                           | except []         |                          |
|         |               |                           |                   |                          |
+         +               +                           +-------------------+--------------------------+
|         |               |                           | no pods           | no ports, no protocols   |
|         |               |                           |                   |                          |
|         |               |                           |                   |                          |
+---------+---------------+---------------------------+-------------------+--------------------------+
|         |               |                           |                   |                          |
+---------+---------------+---------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress
  namespace: x
spec:
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:54:36Z" level=info msg="finished policy #106"
time="2021-03-27T16:54:36Z" level=info msg="starting test case #107"
time="2021-03-27T16:54:39Z" level=info msg="cluster state reset"
time="2021-03-27T16:54:42Z" level=info msg="cluster state verified"
time="2021-03-27T16:54:42Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:54:47Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:54:47Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by IP + allow all by pod to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+----------------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |        SOURCE RULES        |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+----------------------------+-------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-ip   | ports for all IPs | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-pod |                   |                          |
|         |   pod: b      |                            |                   |                          |
+         +               +                            +-------------------+--------------------------+
|         |               |                            | 0.0.0.0/31        | all ports, all protocols |
|         |               |                            | except []         |                          |
|         |               |                            |                   |                          |
+         +               +                            +-------------------+                          +
|         |               |                            | all pods          |                          |
|         |               |                            |                   |                          |
|         |               |                            |                   |                          |
+---------+---------------+----------------------------+-------------------+--------------------------+
|         |               |                            |                   |                          |
+---------+---------------+----------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-pod
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector: {}
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:55:20Z" level=info msg="finished policy #107"
time="2021-03-27T16:55:20Z" level=info msg="starting test case #108"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:55:23Z" level=info msg="cluster state reset"
time="2021-03-27T16:55:26Z" level=info msg="cluster state verified"
time="2021-03-27T16:55:26Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:55:31Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:55:31Z" level=info msg="running kube probe on try 1"
evaluating test case: deny all by pod + allow all by IP to same source
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+---------------------------+----------------------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES        |               PEER               |      PORT/PROTOCOL       |
+---------+---------------+---------------------------+----------------------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-pod | ports for all IPs                | no ports, no protocols   |
|         | Match labels: | x/allow-all-ingress-by-ip |                                  |                          |
|         |   pod: b      |                           |                                  |                          |
+         +               +                           +----------------------------------+--------------------------+
|         |               |                           | 0.0.0.0/0                        | all ports, all protocols |
|         |               |                           | except []                        |                          |
|         |               |                           |                                  |                          |
+         +               +                           +----------------------------------+                          +
|         |               |                           | namespace: Match labels:         |                          |
|         |               |                           |   this-will-never-happen: qrs123 |                          |
|         |               |                           | pods: all                        |                          |
+---------+---------------+---------------------------+----------------------------------+--------------------------+
|         |               |                           |                                  |                          |
+---------+---------------+---------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-pod
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/0
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:56:04Z" level=info msg="finished policy #108"
time="2021-03-27T16:56:04Z" level=info msg="starting test case #109"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:56:07Z" level=info msg="cluster state reset"
time="2021-03-27T16:56:10Z" level=info msg="cluster state verified"
time="2021-03-27T16:56:10Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:56:15Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:56:15Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: deny all by IP
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+-------------------------+-------------------+--------------------------+
|  TYPE  |    TARGET     |      SOURCE RULES       |       PEER        |      PORT/PROTOCOL       |
+--------+---------------+-------------------------+-------------------+--------------------------+
|        |               |                         |                   |                          |
+--------+---------------+-------------------------+-------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-ip | ports for all IPs | port 53 on protocol UDP  |
|        | Match labels: | x/allow-dns             |                   |                          |
|        |   pod: b      |                         |                   |                          |
+        +               +                         +-------------------+--------------------------+
|        |               |                         | 0.0.0.0/31        | all ports, all protocols |
|        |               |                         | except []         |                          |
|        |               |                         |                   |                          |
+        +               +                         +-------------------+--------------------------+
|        |               |                         | namespace: all    | port 53 on protocol UDP  |
|        |               |                         | pods: all         |                          |
|        |               |                         |                   |                          |
+--------+---------------+-------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:56:48Z" level=info msg="finished policy #109"
time="2021-03-27T16:56:48Z" level=info msg="starting test case #110"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:56:51Z" level=info msg="cluster state reset"
time="2021-03-27T16:56:54Z" level=info msg="cluster state verified"
time="2021-03-27T16:56:54Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:56:59Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:56:59Z" level=info msg="running kube probe on try 1"
evaluating test case: egress: deny all by pod
step 1 on all available ports/protocols:
Policy explanation:
+--------+---------------+-------------------------+----------------------------------+--------------------------+
|  TYPE  |    TARGET     |      SOURCE RULES       |               PEER               |      PORT/PROTOCOL       |
+--------+---------------+-------------------------+----------------------------------+--------------------------+
|        |               |                         |                                  |                          |
+--------+---------------+-------------------------+----------------------------------+--------------------------+
| Egress | namespace: x  | x/deny-all-egress-by-ip | ports for all IPs                | port 53 on protocol UDP  |
|        | Match labels: | x/allow-dns             |                                  |                          |
|        |   pod: b      |                         |                                  |                          |
+        +               +                         +----------------------------------+--------------------------+
|        |               |                         | namespace: Match labels:         | all ports, all protocols |
|        |               |                         |   this-will-never-happen: qrs123 |                          |
|        |               |                         | pods: all                        |                          |
+        +               +                         +----------------------------------+--------------------------+
|        |               |                         | namespace: all                   | port 53 on protocol UDP  |
|        |               |                         | pods: all                        |                          |
|        |               |                         |                                  |                          |
+--------+---------------+-------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-egress-by-ip
  namespace: x
spec:
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: allow-dns
  namespace: x
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Egress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:57:33Z" level=info msg="finished policy #110"
time="2021-03-27T16:57:33Z" level=info msg="starting test case #111"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
|         | X   | X   | X   | X   | X   | X   | X   | X   | X   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | .   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:57:35Z" level=info msg="cluster state reset"
time="2021-03-27T16:57:38Z" level=info msg="cluster state verified"
time="2021-03-27T16:57:38Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:57:43Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:57:43Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: deny all by IP
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------------------+-------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES       |       PEER        |      PORT/PROTOCOL       |
+---------+---------------+--------------------------+-------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-ip | ports for all IPs | no ports, no protocols   |
|         | Match labels: |                          |                   |                          |
|         |   pod: b      |                          |                   |                          |
+         +               +                          +-------------------+--------------------------+
|         |               |                          | 0.0.0.0/31        | all ports, all protocols |
|         |               |                          | except []         |                          |
|         |               |                          |                   |                          |
+         +               +                          +-------------------+--------------------------+
|         |               |                          | no pods           | no ports, no protocols   |
|         |               |                          |                   |                          |
|         |               |                          |                   |                          |
+---------+---------------+--------------------------+-------------------+--------------------------+
|         |               |                          |                   |                          |
+---------+---------------+--------------------------+-------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - ipBlock:
        cidr: 0.0.0.0/31
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
time="2021-03-27T16:58:16Z" level=info msg="finished policy #111"
time="2021-03-27T16:58:16Z" level=info msg="starting test case #112"
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:58:19Z" level=info msg="cluster state reset"
time="2021-03-27T16:58:22Z" level=info msg="cluster state verified"
time="2021-03-27T16:58:22Z" level=info msg="step 1: waiting 5.000000 seconds for perturbation to take effect"
time="2021-03-27T16:58:27Z" level=info msg="running probe &{AllAvailable:true PortProtocol:<nil> Mode:service-name}"
time="2021-03-27T16:58:27Z" level=info msg="running kube probe on try 1"
evaluating test case: ingress: deny all by pod
step 1 on all available ports/protocols:
Policy explanation:
+---------+---------------+--------------------------+----------------------------------+--------------------------+
|  TYPE   |    TARGET     |       SOURCE RULES       |               PEER               |      PORT/PROTOCOL       |
+---------+---------------+--------------------------+----------------------------------+--------------------------+
| Ingress | namespace: x  | x/deny-all-ingress-by-ip | no ips                           | no ports, no protocols   |
|         | Match labels: |                          |                                  |                          |
|         |   pod: b      |                          |                                  |                          |
+         +               +                          +----------------------------------+--------------------------+
|         |               |                          | namespace: Match labels:         | all ports, all protocols |
|         |               |                          |   this-will-never-happen: qrs123 |                          |
|         |               |                          | pods: all                        |                          |
+---------+---------------+--------------------------+----------------------------------+--------------------------+
|         |               |                          |                                  |                          |
+---------+---------------+--------------------------+----------------------------------+--------------------------+



Results for network policies:
Network policy:

apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  creationTimestamp: null
  name: deny-all-ingress-by-ip
  namespace: x
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          this-will-never-happen: qrs123
  podSelector:
    matchLabels:
      pod: b
  policyTypes:
  - Ingress

0 wrong, 0 ignored, 81 correct
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| SCTP/80 | X/A | X/B | X/C | Y/A | Y/B | Y/C | Z/A | Z/B | Z/C |
| SCTP/81 |     |     |     |     |     |     |     |     |     |
| TCP/80  |     |     |     |     |     |     |     |     |     |
| TCP/81  |     |     |     |     |     |     |     |     |     |
| UDP/80  |     |     |     |     |     |     |     |     |     |
| UDP/81  |     |     |     |     |     |     |     |     |     |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/a     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/b     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| x/c     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/a     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/b     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| y/c     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/a     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/b     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+
| z/c     | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
|         | .   | X   | .   | .   | .   | .   | .   | .   | .   |
+---------+-----+-----+-----+-----+-----+-----+-----+-----+-----+



time="2021-03-27T16:59:00Z" level=info msg="finished policy #112"
Summary:
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                           TEST                                            | RESULT |   STEP/TRY    | WRONG | RIGHT | IGNORED |       TCP        |       SCTP       |       UDP        |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 1: set namespace to x                                                                     | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 2: set namespace to y                                                                     | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 3: set namespace to z                                                                     | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 4: set pod selector to                                                                    | passed |               |       |       |         |                  |                  |                  |
| ["MatchLabels",null,"MatchExpression",null]                                               |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 5: set pod selector to                                                                    | passed |               |       |       |         |                  |                  |                  |
| ["MatchLabels",["pod:                                                                     |        |               |       |       |         |                  |                  |                  |
| a"],"MatchExpression",null]                                                               |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 6: set pod selector to                                                                    | passed |               |       |       |         |                  |                  |                  |
| ["MatchLabels",null,"MatchExpression",[{"key":"pod","operator":"In","values":["a","b"]}]] |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 7: egress: deny all                                                                       | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 8: egress: allow all                                                                      | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 9: ingress: deny all                                                                      | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 10: ingress: allow all                                                                    | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 11: ingress: empty peers                                                                  | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 12: egress: empty peers                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 13: empty pods + nil ns                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 14: pods by label + nil ns                                                                | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 15: nil pods + empty ns                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 16: empty pods + empty ns                                                                 | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     1 |    80 |       0 | 161 / 162 (99%)  | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 2 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 17: pods by label + empty ns                                                              | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 18: nil pods + ns by label                                                                | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 19: empty pods + ns by label                                                              | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 20: pods by label + ns by                                                                 | passed |               |       |       |         |                  |                  |                  |
| label                                                                                     |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 21: simple ipblock                                                                        | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 22: ipblock with except                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 23: empty pods + nil ns                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 24: pods by label + nil ns                                                                | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 25: nil pods + empty ns                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 26: empty pods + empty ns                                                                 | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 27: pods by label + empty ns                                                              | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 28: nil pods + ns by label                                                                | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 29: empty pods + ns by label                                                              | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 30: pods by label + ns by                                                                 | passed |               |       |       |         |                  |                  |                  |
| label                                                                                     |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 31: simple ipblock                                                                        | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 32: ipblock with except                                                                   | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 33: egress: empty                                                                         | passed |               |       |       |         |                  |                  |                  |
| port/protocol                                                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 34: ingress: empty                                                                        | passed |               |       |       |         |                  |                  |                  |
| port/protocol                                                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 35:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,port                                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 36:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port                                                       |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 37:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port                                                       |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 38:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,port,protocol,tcp                                               |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 39:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port,protocol,tcp                                          |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 40:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port,protocol,tcp                                          |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 41:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,port,protocol,udp                                               |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 42:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port,protocol,udp                                          |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 43:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port,protocol,udp                                          |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 44:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,port,protocol,sctp                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 45:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port,protocol,sctp                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 46:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,numbered-port,port,protocol,sctp                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 47:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,named-port,port,protocol,tcp                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 48:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,named-port,port,protocol,tcp                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 49:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,named-port,port,protocol,udp                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 50:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,named-port,port,protocol,udp                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 51:                                                                                       | failed |               |       |       |         |                  |                  |                  |
| direction,egress,named-port,port,protocol,sctp                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 2 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 52:                                                                                       | failed |               |       |       |         |                  |                  |                  |
| direction,egress,named-port,port,protocol,sctp                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 2 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 53: open a named port that                                                                | passed |               |       |       |         |                  |                  |                  |
| doesn't match its protocol                                                                |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 54: open a named port that                                                                | passed |               |       |       |         |                  |                  |                  |
| isn't served                                                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 55: open a numbered port that                                                             | passed |               |       |       |         |                  |                  |                  |
| isn't served                                                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 56:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,port                                                           |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 57:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port                                                      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 58:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port                                                      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 59:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,port,protocol,tcp                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 60:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port,protocol,tcp                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 61:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port,protocol,tcp                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 62:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,port,protocol,udp                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 63:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port,protocol,udp                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 64:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port,protocol,udp                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 65:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,port,protocol,sctp                                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 66:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port,protocol,sctp                                        |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 67:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,numbered-port,port,protocol,sctp                                        |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 68:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,named-port,port,protocol,tcp                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 69:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,named-port,port,protocol,tcp                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 70:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,named-port,port,protocol,udp                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 71:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,named-port,port,protocol,udp                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 72:                                                                                       | failed |               |       |       |         |                  |                  |                  |
| direction,ingress,named-port,port,protocol,sctp                                           |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 2 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 73:                                                                                       | failed |               |       |       |         |                  |                  |                  |
| direction,ingress,named-port,port,protocol,sctp                                           |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 2 |     4 |    77 |       0 | 162 / 162 (100%) | 158 / 162 (97%)  | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 74: open a named port that                                                                | passed |               |       |       |         |                  |                  |                  |
| doesn't match its protocol                                                                |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 75: open a named port that                                                                | passed |               |       |       |         |                  |                  |                  |
| isn't served                                                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 76: open a numbered port that                                                             | passed |               |       |       |         |                  |                  |                  |
| isn't served                                                                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 77:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,multi-port/protocol,numbered-port,port,rule                     |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 78:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,multi-port/protocol,named-port,port,rule                        |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 79:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,egress,multi-port/protocol,port,protocol,rule,udp                      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 80:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,multi-port/protocol,numbered-port,port,rule                              |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 81:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,multi-port/protocol,named-port,numbered-port,port,rule                   |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 82:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 83:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,egress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 84:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,multi-port/protocol,numbered-port,port,rule                    |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 85:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,multi-port/protocol,named-port,port,rule                       |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 86:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| any-port,direction,ingress,multi-port/protocol,port,protocol,rule,udp                     |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 87:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,multi-port/protocol,numbered-port,port,rule                             |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 88:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,multi-port/protocol,named-port,numbered-port,port,rule                  |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 89:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp     |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 90:                                                                                       | passed |               |       |       |         |                  |                  |                  |
| direction,ingress,multi-port/protocol,named-port,numbered-port,port,protocol,rule,udp     |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 91: Create/delete policy                                                                  | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 92: Create/update policy                                                                  | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 93: Create/delete namespace                                                               | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |   121 |       0 | 242 / 242 (100%) | 242 / 242 (100%) | 242 / 242 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 94: Update namespace so that                                                              | passed |               |       |       |         |                  |                  |                  |
| policy applies, then again so                                                             |        |               |       |       |         |                  |                  |                  |
| it no longer applies                                                                      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 95: Create/delete pod                                                                     | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |   100 |       0 | 200 / 200 (100%) | 200 / 200 (100%) | 200 / 200 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 96: Update pod so that policy                                                             | passed |               |       |       |         |                  |                  |                  |
| applies, then again so it no                                                              |        |               |       |       |         |                  |                  |                  |
| longer applies                                                                            |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 2, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 3, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 97: deny all from source,                                                                 | passed |               |       |       |         |                  |                  |                  |
| allow all to dest                                                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 98: allow all from source,                                                                | passed |               |       |       |         |                  |                  |                  |
| deny all to dest                                                                          |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 99: deny all + allow all from                                                             | passed |               |       |       |         |                  |                  |                  |
| same source                                                                               |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 100: deny all + allow all to                                                              | passed |               |       |       |         |                  |                  |                  |
| same dest                                                                                 |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 101: deny all + allow all by                                                              | passed |               |       |       |         |                  |                  |                  |
| pod from same source                                                                      |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 102: deny all + allow all by                                                              | passed |               |       |       |         |                  |                  |                  |
| IP from same source                                                                       |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 103: deny all by IP + allow                                                               | passed |               |       |       |         |                  |                  |                  |
| all by pod from same source                                                               |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 104: deny all by pod + allow                                                              | passed |               |       |       |         |                  |                  |                  |
| all by IP from same source                                                                |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 105: deny all + allow all by                                                              | passed |               |       |       |         |                  |                  |                  |
| pod to same source                                                                        |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 106: deny all + allow all by                                                              | passed |               |       |       |         |                  |                  |                  |
| IP to same source                                                                         |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 107: deny all by IP + allow                                                               | passed |               |       |       |         |                  |                  |                  |
| all by pod to same source                                                                 |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 108: deny all by pod + allow                                                              | passed |               |       |       |         |                  |                  |                  |
| all by IP to same source                                                                  |        |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 109: egress: deny all by IP                                                               | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 110: egress: deny all by pod                                                              | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 111: ingress: deny all by IP                                                              | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
| 112: ingress: deny all by pod                                                             | passed |               |       |       |         |                  |                  |                  |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+
|                                                                                           |        | Step 1, try 1 |     0 |    81 |       0 | 162 / 162 (100%) | 162 / 162 (100%) | 162 / 162 (100%) |
+-------------------------------------------------------------------------------------------+--------+---------------+-------+-------+---------+------------------+------------------+------------------+

peer-pods counts:
+---------------------+--------+--------+----------+
|       FEATURE       | PASSED | FAILED | PASSED % |
+---------------------+--------+--------+----------+
| namespaces-by-label |      6 |      0 |      100 |
| policy-namespace    |      4 |      0 |      100 |
| all-pods            |     14 |      0 |      100 |
| pods-by-label       |      6 |      0 |      100 |
| all-namespaces      |     10 |      0 |      100 |
+---------------------+--------+--------+----------+

peer-ipblock counts:
+----------------------+--------+--------+----------+
|       FEATURE        | PASSED | FAILED | PASSED % |
+----------------------+--------+--------+----------+
| ip-block-with-except |      2 |      0 |      100 |
| ip-block-no-except   |      2 |      0 |      100 |
+----------------------+--------+--------+----------+

protocol counts:
+---------+--------+--------+----------+
| FEATURE | PASSED | FAILED | PASSED % |
+---------+--------+--------+----------+
| sctp    |      6 |      4 |       60 |
| tcp     |     16 |      0 |      100 |
| udp     |     16 |      0 |      100 |
+---------+--------+--------+----------+

miscellaneous counts:
+--------------+--------+--------+----------+
|   FEATURE    | PASSED | FAILED | PASSED % |
+--------------+--------+--------+----------+
| pathological |      6 |      0 |      100 |
| conflict     |     16 |      0 |      100 |
+--------------+--------+--------+----------+

action counts:
+----------------------+--------+--------+----------+
|       FEATURE        | PASSED | FAILED | PASSED % |
+----------------------+--------+--------+----------+
| create-policy        |      2 |      0 |      100 |
| delete-policy        |      1 |      0 |      100 |
| delete-namespace     |      1 |      0 |      100 |
| set-pod-labels       |      1 |      0 |      100 |
| delete-pod           |      1 |      0 |      100 |
| update-policy        |      1 |      0 |      100 |
| create-namespace     |      1 |      0 |      100 |
| set-namespace-labels |      1 |      0 |      100 |
| create-pod           |      1 |      0 |      100 |
+----------------------+--------+--------+----------+

target counts:
+---------------------+--------+--------+----------+
|       FEATURE       | PASSED | FAILED | PASSED % |
+---------------------+--------+--------+----------+
| target-namespace    |      3 |      0 |      100 |
| target-pod-selector |      3 |      0 |      100 |
+---------------------+--------+--------+----------+

direction counts:
+---------+--------+--------+----------+
| FEATURE | PASSED | FAILED | PASSED % |
+---------+--------+--------+----------+
| egress  |     49 |      2 |       96 |
| ingress |     49 |      2 |       96 |
+---------+--------+--------+----------+

rule counts:
+---------------------+--------+--------+----------+
|       FEATURE       | PASSED | FAILED | PASSED % |
+---------------------+--------+--------+----------+
| deny-all            |     10 |      0 |      100 |
| allow-all           |      6 |      0 |      100 |
| any-peer            |      2 |      0 |      100 |
| any-port-protocol   |      2 |      0 |      100 |
| multi-port/protocol |     14 |      0 |      100 |
+---------------------+--------+--------+----------+

port counts:
+---------------+--------+--------+----------+
|    FEATURE    | PASSED | FAILED | PASSED % |
+---------------+--------+--------+----------+
| named-port    |     20 |      4 |       83 |
| any-port      |     14 |      0 |      100 |
| numbered-port |     28 |      0 |      100 |
+---------------+--------+--------+----------+

Pass/Fail for probes on protocols:
+---------------+--------+--------+----------+
|   PROTOCOL    | PASSED | FAILED | PASSED % |
+---------------+--------+--------+----------+
| probe on TCP  |  20691 |      1 |       99 |
| probe on SCTP |  20660 |     32 |       99 |
| probe on UDP  |  20692 |      0 |      100 |
+---------------+--------+--------+----------+
```

# Feature results:

| Tag | Result |
| --- | --- |
| action | 108 / 112 = 96%  |
|  - action: create namespace | 1 / 1 = 100%  |
|  - action: create pod | 2 / 2 = 100%  |
|  - action: create policy | 108 / 112 = 96%  |
|  - action: delete namespace | 1 / 1 = 100%  |
|  - action: delete pod | 1 / 1 = 100%  |
|  - action: delete policy | 1 / 1 = 100%  |
|  - action: set namespace labels | 1 / 1 = 100%  |
|  - action: set pod labels | 1 / 1 = 100%  |
|  - action: update policy | 1 / 1 = 100%  |
| egress | 108 / 112 = 96%  |
|  - 0 peers | 100 / 104 = 96%  |
|  - 0 port/protocols | 10 / 10 = 100%  |
|  - 0 rules | 13 / 13 = 100%  |
|  - 1 peer | 95 / 99 = 95%  |
|  - 1 port/protocol | 99 / 103 = 96%  |
|  - 1 rule | 10 / 10 = 100%  |
|  - 2+ port/protocols | 7 / 7 = 100%  |
|  - 2+ rules | 90 / 94 = 95%  |
|  - IPBlock (no except) | 5 / 5 = 100%  |
|  - IPBlock with except | 1 / 1 = 100%  |
|  - all peers on all ports/protocols | 3 / 3 = 100%  |
|  - named port | 10 / 12 = 83%  |
|  - nil port | 7 / 7 = 100%  |
|  - nil protocol | 9 / 9 = 100%  |
|  - numbered port | 99 / 103 = 96%  |
|  - peer namespace selector empty | 5 / 5 = 100%  |
|  - peer namespace selector match expression | 79 / 83 = 95%  |
|  - peer namespace selector match labels | 5 / 5 = 100%  |
|  - peer namespace selector nil | 2 / 2 = 100%  |
|  - peer pod selector empty | 3 / 3 = 100%  |
|  - peer pod selector match expression | 79 / 83 = 95%  |
|  - peer pod selector match labels | 3 / 3 = 100%  |
|  - peer pod selector nil | 6 / 6 = 100%  |
|  - policy on SCTP | 3 / 5 = 60%  |
|  - policy on TCP | 71 / 73 = 97%  |
|  - policy on UDP | 99 / 103 = 96%  |
| general | 108 / 112 = 96%  |
|  - policy with both ingress and egress | 90 / 94 = 95%  |
|  - policy with egress | 100 / 104 = 96%  |
|  - policy with ingress | 99 / 103 = 96%  |
|  - target: empty pod selector | 1 / 1 = 100%  |
|  - target: pod selector match expression | 1 / 1 = 100%  |
|  - target: pod selector match labels | 106 / 110 = 96%  |
|  - target: specific namespace | 108 / 112 = 96%  |
| ingress | 108 / 112 = 96%  |
|  - 0 peers | 4 / 4 = 100%  |
|  - 0 port/protocols | 10 / 10 = 100%  |
|  - 0 rules | 13 / 13 = 100%  |
|  - 1 peer | 95 / 99 = 95%  |
|  - 1 port/protocol | 82 / 86 = 95%  |
|  - 1 rule | 99 / 103 = 96%  |
|  - 2+ port/protocols | 7 / 7 = 100%  |
|  - IPBlock (no except) | 5 / 5 = 100%  |
|  - IPBlock with except | 1 / 1 = 100%  |
|  - all peers on all ports/protocols | 3 / 3 = 100%  |
|  - named port | 11 / 13 = 84%  |
|  - nil port | 7 / 7 = 100%  |
|  - nil protocol | 9 / 9 = 100%  |
|  - numbered port | 77 / 79 = 97%  |
|  - peer namespace selector empty | 5 / 5 = 100%  |
|  - peer namespace selector match expression | 78 / 82 = 95%  |
|  - peer namespace selector match labels | 6 / 6 = 100%  |
|  - peer namespace selector nil | 2 / 2 = 100%  |
|  - peer pod selector empty | 3 / 3 = 100%  |
|  - peer pod selector match expression | 77 / 81 = 95%  |
|  - peer pod selector match labels | 4 / 4 = 100%  |
|  - peer pod selector nil | 7 / 7 = 100%  |
|  - policy on SCTP | 3 / 5 = 60%  |
|  - policy on TCP | 71 / 73 = 97%  |
|  - policy on UDP | 9 / 9 = 100%  |

Tag results:
| Tag | Result |
| --- | --- |
| action | 6 / 6 = 100%  |
|  - create-namespace | 1 / 1 = 100%  |
|  - create-pod | 1 / 1 = 100%  |
|  - create-policy | 2 / 2 = 100%  |
|  - delete-namespace | 1 / 1 = 100%  |
|  - delete-pod | 1 / 1 = 100%  |
|  - delete-policy | 1 / 1 = 100%  |
|  - set-namespace-labels | 1 / 1 = 100%  |
|  - set-pod-labels | 1 / 1 = 100%  |
|  - update-policy | 1 / 1 = 100%  |
| direction | 96 / 100 = 96%  |
|  - egress | 49 / 51 = 96%  |
|  - ingress | 49 / 51 = 96%  |
| miscellaneous | 22 / 22 = 100%  |
|  - conflict | 16 / 16 = 100%  |
|  - pathological | 6 / 6 = 100%  |
| peer-ipblock | 4 / 4 = 100%  |
|  - ip-block-no-except | 2 / 2 = 100%  |
|  - ip-block-with-except | 2 / 2 = 100%  |
| peer-pods | 20 / 20 = 100%  |
|  - all-namespaces | 10 / 10 = 100%  |
|  - all-pods | 14 / 14 = 100%  |
|  - namespaces-by-label | 6 / 6 = 100%  |
|  - pods-by-label | 6 / 6 = 100%  |
|  - policy-namespace | 4 / 4 = 100%  |
| port | 52 / 56 = 92%  |
|  - any-port | 14 / 14 = 100%  |
|  - named-port | 20 / 24 = 83%  |
|  - numbered-port | 28 / 28 = 100%  |
| protocol | 38 / 42 = 90%  |
|  - sctp | 6 / 10 = 60%  |
|  - tcp | 16 / 16 = 100%  |
|  - udp | 16 / 16 = 100%  |
| rule | 30 / 30 = 100%  |
|  - allow-all | 6 / 6 = 100%  |
|  - any-peer | 2 / 2 = 100%  |
|  - any-port-protocol | 2 / 2 = 100%  |
|  - deny-all | 10 / 10 = 100%  |
|  - multi-port/protocol | 14 / 14 = 100%  |
| target | 6 / 6 = 100%  |
|  - target-namespace | 3 / 3 = 100%  |
|  - target-pod-selector | 3 / 3 = 100%  |
